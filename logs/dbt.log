

============================== 2022-04-05 18:53:22.689278 | 224c643f-f060-4043-be56-5c0481529293 ==============================
18:53:22.689278 [info ] [MainThread]: Running with dbt=1.0.4
18:53:22.689572 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, project_name=None, skip_profile_setup=False, defer=None, state=None, cls=<class 'dbt.task.init.InitTask'>, which='init', rpc_method=None)
18:53:22.689683 [debug] [MainThread]: Tracking: tracking
18:53:22.735484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110feae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110feaca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110feacd0>]}
18:53:33.955179 [debug] [MainThread]: Starter project path: /usr/local/Cellar/dbt-bigquery/1.0.0_3/libexec/lib/python3.9/site-packages/dbt/include/starter_project
18:54:53.790777 [info ] [MainThread]: Profile jaffle_shop written to /Users/lizyau/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
18:54:53.791813 [info ] [MainThread]: 
Your new dbt project "jaffle_shop" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

18:54:53.792302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110073d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111007760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111007b20>]}


============================== 2022-04-06 20:51:25.435673 | cc84e162-47a8-42c8-9484-99c56c8c9c67 ==============================
20:51:25.435673 [info ] [MainThread]: Running with dbt=1.0.4
20:51:25.435975 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, project_name='test-project', skip_profile_setup=False, defer=None, state=None, cls=<class 'dbt.task.init.InitTask'>, which='init', rpc_method=None)
20:51:25.436097 [debug] [MainThread]: Tracking: tracking
20:51:25.469913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d48b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d48b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d48b160>]}
20:51:37.641150 [debug] [MainThread]: Starter project path: /usr/local/Cellar/dbt-bigquery/1.0.0_3/libexec/lib/python3.9/site-packages/dbt/include/starter_project
20:53:10.533563 [info ] [MainThread]: Profile testproject written to /Users/lizyau/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
20:53:10.534584 [info ] [MainThread]: 
Your new dbt project "testproject" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

20:53:10.535126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d47bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f03df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f05b9a0>]}


============================== 2022-04-08 21:26:35.300728 | 0169cf24-3593-4715-8141-24ebb47bc363 ==============================
21:26:35.300728 [info ] [MainThread]: Running with dbt=1.0.4
21:26:35.301692 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
21:26:35.301910 [debug] [MainThread]: Tracking: tracking
21:26:35.338924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130966d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111478730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113020ca0>]}
21:26:35.360652 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
21:26:35.361002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0169cf24-3593-4715-8141-24ebb47bc363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113054670>]}
21:26:35.374998 [debug] [MainThread]: Parsing macros/etc.sql
21:26:35.376903 [debug] [MainThread]: Parsing macros/catalog.sql
21:26:35.382082 [debug] [MainThread]: Parsing macros/adapters.sql
21:26:35.399690 [debug] [MainThread]: Parsing macros/materializations/seed.sql
21:26:35.401491 [debug] [MainThread]: Parsing macros/materializations/view.sql
21:26:35.403167 [debug] [MainThread]: Parsing macros/materializations/table.sql
21:26:35.406425 [debug] [MainThread]: Parsing macros/materializations/copy.sql
21:26:35.408343 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
21:26:35.419922 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
21:26:35.423052 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:26:35.426087 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:26:35.427693 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:26:35.428775 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:26:35.440652 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:26:35.449083 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:26:35.458089 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:26:35.461301 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:26:35.462482 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:26:35.463616 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:26:35.466743 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:26:35.475114 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:26:35.476421 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:26:35.483398 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:26:35.495043 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:26:35.500502 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:26:35.502324 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:26:35.507398 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:26:35.508219 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:26:35.509990 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:26:35.511646 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:26:35.515976 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:26:35.528028 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:26:35.529288 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:26:35.530970 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:26:35.532332 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:26:35.532936 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:26:35.533276 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:26:35.533711 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:26:35.534595 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:26:35.537475 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:26:35.543733 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:26:35.545264 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:26:35.547191 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:26:35.554001 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:26:35.555986 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:26:35.558865 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:26:35.563917 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:26:35.570859 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:26:35.710728 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
21:26:35.718803 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
21:26:35.723663 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
21:26:35.740515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0169cf24-3593-4715-8141-24ebb47bc363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131ed760>]}
21:26:35.744948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0169cf24-3593-4715-8141-24ebb47bc363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131ed2b0>]}
21:26:35.745185 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:26:35.746151 [info ] [MainThread]: 
21:26:35.746514 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:26:35.747242 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323"
21:26:35.747534 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:26:36.462681 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:26:36.463270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:26:37.110899 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:26:37.111383 [info ] [MainThread]: 
21:26:37.129874 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
21:26:37.130046 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
21:26:37.130303 [info ] [Thread-1  ]: 1 of 3 START view model jaffle_shop.stg_customers............................... [RUN]
21:26:37.130505 [info ] [Thread-2  ]: 2 of 3 START view model jaffle_shop.stg_orders.................................. [RUN]
21:26:37.130894 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
21:26:37.131235 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
21:26:37.131366 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
21:26:37.131482 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
21:26:37.131629 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
21:26:37.131738 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
21:26:37.132853 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
21:26:37.133709 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
21:26:37.134329 [debug] [Thread-2  ]: finished collecting timing info
21:26:37.134430 [debug] [Thread-1  ]: finished collecting timing info
21:26:37.134558 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
21:26:37.134679 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
21:26:37.158909 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
21:26:37.161082 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
21:26:37.161731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:26:37.161955 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:26:37.162947 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  OPTIONS()
  as with customers as  (
    select 
        id as customer_id,
        first_name,
        last name
    from raw.jaffle_shop.customers
)

select * from customers;


21:26:37.163894 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

select * from orders;


21:26:37.887663 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [18:1]')
21:26:37.960757 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('The project raw has not enabled BigQuery.')
21:26:38.269354 [debug] [Thread-1  ]: finished collecting timing info
21:26:38.270658 [debug] [Thread-1  ]: Database Error in model stg_customers (models/staging/jaffle_shop/stg_customers.sql)
  The project raw has not enabled BigQuery.
  compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_customers.sql
21:26:38.271442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0169cf24-3593-4715-8141-24ebb47bc363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132dad90>]}
21:26:38.272166 [error] [Thread-1  ]: 1 of 3 ERROR creating view model jaffle_shop.stg_customers...................... [[31mERROR[0m in 1.14s]
21:26:38.272867 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
21:26:39.071958 [debug] [Thread-2  ]: finished collecting timing info
21:26:39.072835 [debug] [Thread-2  ]: Database Error in model stg_orders (models/staging/jaffle_shop/stg_orders.sql)
  Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [18:1]
  compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_orders.sql
21:26:39.073336 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0169cf24-3593-4715-8141-24ebb47bc363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132da310>]}
21:26:39.073939 [error] [Thread-2  ]: 2 of 3 ERROR creating view model jaffle_shop.stg_orders......................... [[31mERROR[0m in 1.94s]
21:26:39.074701 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
21:26:39.075923 [debug] [Thread-4  ]: Began running node model.jaffle_shop.dim_customers
21:26:39.076366 [info ] [Thread-4  ]: 3 of 3 SKIP relation jaffle_shop.dim_customers.................................. [[33mSKIP[0m]
21:26:39.076879 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.dim_customers
21:26:39.078625 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:26:39.079230 [info ] [MainThread]: 
21:26:39.079664 [info ] [MainThread]: Finished running 2 view models, 1 table model in 3.33s.
21:26:39.080060 [debug] [MainThread]: Connection 'master' was properly closed.
21:26:39.080272 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
21:26:39.080467 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
21:26:39.087896 [info ] [MainThread]: 
21:26:39.088350 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
21:26:39.088720 [info ] [MainThread]: 
21:26:39.089032 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/staging/jaffle_shop/stg_customers.sql)[0m
21:26:39.089334 [error] [MainThread]:   The project raw has not enabled BigQuery.
21:26:39.089621 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_customers.sql
21:26:39.089903 [info ] [MainThread]: 
21:26:39.090188 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/staging/jaffle_shop/stg_orders.sql)[0m
21:26:39.090472 [error] [MainThread]:   Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [18:1]
21:26:39.090750 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_orders.sql
21:26:39.091035 [info ] [MainThread]: 
21:26:39.091339 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
21:26:39.091753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113176dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130cf460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132fbd30>]}


============================== 2022-04-08 21:33:07.036857 | 5f346e7f-3ab8-46b9-80ad-db718b783f2a ==============================
21:33:07.036857 [info ] [MainThread]: Running with dbt=1.0.4
21:33:07.037904 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
21:33:07.038254 [debug] [MainThread]: Tracking: tracking
21:33:07.067123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b7abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efb0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efb03a0>]}
21:33:07.097557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
21:33:07.097973 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_orders.sql
21:33:07.098162 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
21:33:07.098321 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_customers.sql
21:33:07.109414 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
21:33:07.119405 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
21:33:07.122004 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
21:33:07.129480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f346e7f-3ab8-46b9-80ad-db718b783f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d060d0>]}
21:33:07.133709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f346e7f-3ab8-46b9-80ad-db718b783f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bef6d0>]}
21:33:07.134013 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:33:07.135178 [info ] [MainThread]: 
21:33:07.135642 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:33:07.136412 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323"
21:33:07.136632 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:33:07.861715 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:33:07.862286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:33:08.401060 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:33:08.401842 [info ] [MainThread]: 
21:33:08.410302 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
21:33:08.410655 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
21:33:08.411204 [info ] [Thread-1  ]: 1 of 3 START view model jaffle_shop.stg_customers............................... [RUN]
21:33:08.411645 [info ] [Thread-2  ]: 2 of 3 START view model jaffle_shop.stg_orders.................................. [RUN]
21:33:08.412412 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
21:33:08.413075 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
21:33:08.413392 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
21:33:08.413659 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
21:33:08.414141 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
21:33:08.414422 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
21:33:08.416246 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
21:33:08.417954 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
21:33:08.418672 [debug] [Thread-1  ]: finished collecting timing info
21:33:08.418922 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
21:33:08.425353 [debug] [Thread-2  ]: finished collecting timing info
21:33:08.450609 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
21:33:08.450808 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
21:33:08.453035 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
21:33:08.453505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:33:08.453782 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:33:08.454916 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  OPTIONS()
  as with customers as  (
    select 
        id as customer_id,
        first_name,
        last name
    from dbt-fundamentals-346323.jaffle_shop.customers
)

select * from customers;


21:33:08.456577 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from dbt-fundamentals-346323.jaffle_shop.orders

)

select * from orders;


21:33:09.632078 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: last at [10:9]')
21:33:10.131033 [debug] [Thread-2  ]: finished collecting timing info
21:33:10.131663 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f346e7f-3ab8-46b9-80ad-db718b783f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca3c70>]}
21:33:10.132035 [info ] [Thread-2  ]: 2 of 3 OK created view model jaffle_shop.stg_orders............................. [[32mOK[0m in 1.72s]
21:33:10.132344 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
21:33:10.526873 [debug] [Thread-1  ]: finished collecting timing info
21:33:10.528824 [debug] [Thread-1  ]: Database Error in model stg_customers (models/staging/jaffle_shop/stg_customers.sql)
  Unrecognized name: last at [10:9]
  compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_customers.sql
21:33:10.529958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f346e7f-3ab8-46b9-80ad-db718b783f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e9a1f0>]}
21:33:10.530986 [error] [Thread-1  ]: 1 of 3 ERROR creating view model jaffle_shop.stg_customers...................... [[31mERROR[0m in 2.12s]
21:33:10.531789 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
21:33:10.533674 [debug] [Thread-4  ]: Began running node model.jaffle_shop.dim_customers
21:33:10.534210 [info ] [Thread-4  ]: 3 of 3 SKIP relation jaffle_shop.dim_customers.................................. [[33mSKIP[0m]
21:33:10.534834 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.dim_customers
21:33:10.536985 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:33:10.537816 [info ] [MainThread]: 
21:33:10.538311 [info ] [MainThread]: Finished running 2 view models, 1 table model in 3.40s.
21:33:10.538848 [debug] [MainThread]: Connection 'master' was properly closed.
21:33:10.539080 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
21:33:10.539286 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
21:33:10.546752 [info ] [MainThread]: 
21:33:10.547262 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
21:33:10.547650 [info ] [MainThread]: 
21:33:10.548033 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/staging/jaffle_shop/stg_customers.sql)[0m
21:33:10.548343 [error] [MainThread]:   Unrecognized name: last at [10:9]
21:33:10.548642 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_customers.sql
21:33:10.548946 [info ] [MainThread]: 
21:33:10.549247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
21:33:10.549706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c571c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c57250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d94100>]}


============================== 2022-04-08 21:34:33.667124 | 18fd6abe-3263-4b9e-84ec-073507051d60 ==============================
21:34:33.667124 [info ] [MainThread]: Running with dbt=1.0.4
21:34:33.667993 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
21:34:33.668176 [debug] [MainThread]: Tracking: tracking
21:34:33.701639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111def70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111b63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6047c0>]}
21:34:33.738046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:34:33.738470 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_customers.sql
21:34:33.748079 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
21:34:33.761720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18fd6abe-3263-4b9e-84ec-073507051d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111350f40>]}
21:34:33.766096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18fd6abe-3263-4b9e-84ec-073507051d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e8ac0>]}
21:34:33.766320 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:34:33.767216 [info ] [MainThread]: 
21:34:33.767529 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:34:33.768117 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323"
21:34:33.768378 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:34:34.519342 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:34:34.519841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:34:35.160439 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:34:35.160955 [info ] [MainThread]: 
21:34:35.166662 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
21:34:35.166914 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
21:34:35.167309 [info ] [Thread-1  ]: 1 of 3 START view model jaffle_shop.stg_customers............................... [RUN]
21:34:35.167580 [info ] [Thread-2  ]: 2 of 3 START view model jaffle_shop.stg_orders.................................. [RUN]
21:34:35.168080 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
21:34:35.168631 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
21:34:35.168935 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
21:34:35.169248 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
21:34:35.169456 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
21:34:35.169606 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
21:34:35.171116 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
21:34:35.172275 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
21:34:35.172856 [debug] [Thread-2  ]: finished collecting timing info
21:34:35.173028 [debug] [Thread-1  ]: finished collecting timing info
21:34:35.173185 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
21:34:35.173351 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
21:34:35.201506 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
21:34:35.203372 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
21:34:35.203959 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:34:35.204099 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:34:35.205417 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from dbt-fundamentals-346323.jaffle_shop.orders

)

select * from orders;


21:34:35.206316 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  OPTIONS()
  as with customers as  (
    select 
        id as customer_id,
        first_name,
        last_name
    from dbt-fundamentals-346323.jaffle_shop.customers
)

select * from customers;


21:34:36.266466 [debug] [Thread-1  ]: finished collecting timing info
21:34:36.267301 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18fd6abe-3263-4b9e-84ec-073507051d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11141e1c0>]}
21:34:36.267834 [info ] [Thread-1  ]: 1 of 3 OK created view model jaffle_shop.stg_customers.......................... [[32mOK[0m in 1.10s]
21:34:36.269385 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
21:34:36.529663 [debug] [Thread-2  ]: finished collecting timing info
21:34:36.530625 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18fd6abe-3263-4b9e-84ec-073507051d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111438f70>]}
21:34:36.531284 [info ] [Thread-2  ]: 2 of 3 OK created view model jaffle_shop.stg_orders............................. [[32mOK[0m in 1.36s]
21:34:36.531859 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
21:34:36.533004 [debug] [Thread-4  ]: Began running node model.jaffle_shop.dim_customers
21:34:36.533665 [info ] [Thread-4  ]: 3 of 3 START table model jaffle_shop.dim_customers.............................. [RUN]
21:34:36.534534 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
21:34:36.534772 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.dim_customers
21:34:36.534997 [debug] [Thread-4  ]: Compiling model.jaffle_shop.dim_customers
21:34:36.539379 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
21:34:36.540282 [debug] [Thread-4  ]: finished collecting timing info
21:34:36.540519 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.dim_customers
21:34:36.566888 [debug] [Thread-4  ]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
21:34:36.567615 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:34:36.568880 [debug] [Thread-4  ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `dbt-fundamentals-346323`.`jaffle_shop`.`dim_customers`
  
  
  OPTIONS()
  as (
    -- CTE is common table expression
with customers as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
),

orders as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
),


customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
  
21:34:39.733037 [debug] [Thread-4  ]: finished collecting timing info
21:34:39.734327 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18fd6abe-3263-4b9e-84ec-073507051d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d1e80>]}
21:34:39.735064 [info ] [Thread-4  ]: 3 of 3 OK created table model jaffle_shop.dim_customers......................... [[32mCREATE TABLE (100.0 rows, 4.3 KB processed)[0m in 3.20s]
21:34:39.735673 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.dim_customers
21:34:39.738030 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:34:39.738922 [info ] [MainThread]: 
21:34:39.739470 [info ] [MainThread]: Finished running 2 view models, 1 table model in 5.97s.
21:34:39.739858 [debug] [MainThread]: Connection 'master' was properly closed.
21:34:39.740070 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
21:34:39.740286 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
21:34:39.740489 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
21:34:39.752069 [info ] [MainThread]: 
21:34:39.752578 [info ] [MainThread]: [32mCompleted successfully[0m
21:34:39.752954 [info ] [MainThread]: 
21:34:39.753247 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
21:34:39.753630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111de520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11152bca0>]}


============================== 2022-04-08 21:37:05.872921 | 84103b5a-f5ee-4f78-a462-3f7a8164d72d ==============================
21:37:05.872921 [info ] [MainThread]: Running with dbt=1.0.4
21:37:05.873821 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
21:37:05.874010 [debug] [MainThread]: Tracking: tracking
21:37:05.901452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b04cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af37c0>]}
21:37:05.937786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:37:05.938027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:37:05.942948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84103b5a-f5ee-4f78-a462-3f7a8164d72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c390d0>]}
21:37:05.947941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84103b5a-f5ee-4f78-a462-3f7a8164d72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c137f0>]}
21:37:05.948281 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:37:05.949397 [info ] [MainThread]: 
21:37:05.950250 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:37:05.950965 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:37:05.951213 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:37:06.596205 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:37:06.597011 [info ] [MainThread]: 
21:37:06.604363 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
21:37:06.604666 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
21:37:06.605325 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
21:37:06.605860 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
21:37:06.606170 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
21:37:06.606419 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
21:37:06.606707 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
21:37:06.606950 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
21:37:06.609169 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
21:37:06.610948 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
21:37:06.611650 [debug] [Thread-1  ]: finished collecting timing info
21:37:06.611869 [debug] [Thread-2  ]: finished collecting timing info
21:37:06.612169 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
21:37:06.612443 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
21:37:06.612725 [debug] [Thread-1  ]: finished collecting timing info
21:37:06.612940 [debug] [Thread-2  ]: finished collecting timing info
21:37:06.613370 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
21:37:06.613733 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
21:37:06.614404 [debug] [Thread-4  ]: Began running node model.jaffle_shop.dim_customers
21:37:06.614789 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
21:37:06.614964 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.dim_customers
21:37:06.615132 [debug] [Thread-4  ]: Compiling model.jaffle_shop.dim_customers
21:37:06.618027 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
21:37:06.618654 [debug] [Thread-4  ]: finished collecting timing info
21:37:06.618837 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.dim_customers
21:37:06.619006 [debug] [Thread-4  ]: finished collecting timing info
21:37:06.619336 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.dim_customers
21:37:06.620284 [debug] [MainThread]: Connection 'master' was properly closed.
21:37:06.620463 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
21:37:06.620611 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
21:37:06.620761 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
21:37:06.626140 [info ] [MainThread]: Done.
21:37:06.628507 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
21:37:06.628732 [info ] [MainThread]: Building catalog
21:37:06.629268 [debug] [MainThread]: Opening a new connection, currently in state init
21:37:07.194243 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-fundamentals-346323.information_schema"
21:37:07.218396 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:37:07.220072 [debug] [ThreadPool]: On dbt-fundamentals-346323.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbt-fundamentals-346323.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-fundamentals-346323`.`jaffle_shop`.__TABLES__
        where (upper(dataset_id) = upper('jaffle_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-fundamentals-346323`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-fundamentals-346323`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
21:37:10.619382 [info ] [MainThread]: Catalog written to /Users/lizyau/code/dbt-fundamentals/target/catalog.json
21:37:10.619893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e1b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e1b820>]}
21:37:11.045328 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
21:37:11.046048 [debug] [MainThread]: Connection 'dbt-fundamentals-346323.information_schema' was properly closed.


============================== 2022-04-08 21:37:30.818000 | 620ac54e-9e5e-4120-9a60-3e5a41fa9ffb ==============================
21:37:30.818000 [info ] [MainThread]: Running with dbt=1.0.4
21:37:30.819136 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
21:37:30.819393 [debug] [MainThread]: Tracking: tracking
21:37:30.843966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c1250>]}
21:37:30.846889 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
21:37:30.847305 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
21:37:30.847573 [info ] [MainThread]: 
21:37:30.847743 [info ] [MainThread]: 
21:37:30.847920 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-04-08 21:41:55.655054 | 318b7280-00c1-4ea5-8ee8-eb5053401278 ==============================
21:41:55.655054 [info ] [MainThread]: Running with dbt=1.0.4
21:41:55.656111 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
21:41:55.656411 [debug] [MainThread]: Tracking: tracking
21:41:55.683021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efe7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4204f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efea3d0>]}
21:41:55.717417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:41:55.717655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:41:55.721826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '318b7280-00c1-4ea5-8ee8-eb5053401278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1300d0>]}
21:41:55.726549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '318b7280-00c1-4ea5-8ee8-eb5053401278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f10aa30>]}
21:41:55.726850 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:41:55.728028 [info ] [MainThread]: 
21:41:55.728454 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:41:55.729085 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:41:55.729280 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:41:56.419328 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:41:56.419720 [info ] [MainThread]: 
21:41:56.427983 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
21:41:56.428569 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
21:41:56.429359 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
21:41:56.430022 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
21:41:56.430368 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
21:41:56.430652 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
21:41:56.430998 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
21:41:56.431231 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
21:41:56.433713 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
21:41:56.435422 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
21:41:56.436568 [debug] [Thread-1  ]: finished collecting timing info
21:41:56.436809 [debug] [Thread-2  ]: finished collecting timing info
21:41:56.437032 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
21:41:56.437234 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
21:41:56.437451 [debug] [Thread-1  ]: finished collecting timing info
21:41:56.437634 [debug] [Thread-2  ]: finished collecting timing info
21:41:56.438087 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
21:41:56.438610 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
21:41:56.439333 [debug] [Thread-4  ]: Began running node model.jaffle_shop.dim_customers
21:41:56.439876 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
21:41:56.440063 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.dim_customers
21:41:56.440228 [debug] [Thread-4  ]: Compiling model.jaffle_shop.dim_customers
21:41:56.443266 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
21:41:56.443621 [debug] [Thread-4  ]: finished collecting timing info
21:41:56.443739 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.dim_customers
21:41:56.443850 [debug] [Thread-4  ]: finished collecting timing info
21:41:56.444094 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.dim_customers
21:41:56.445027 [debug] [MainThread]: Connection 'master' was properly closed.
21:41:56.445292 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
21:41:56.445446 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
21:41:56.445579 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
21:41:56.450754 [info ] [MainThread]: Done.
21:41:56.453026 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
21:41:56.453261 [info ] [MainThread]: Building catalog
21:41:56.453866 [debug] [MainThread]: Opening a new connection, currently in state init
21:41:57.158158 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-fundamentals-346323.information_schema"
21:41:57.183681 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:41:57.185399 [debug] [ThreadPool]: On dbt-fundamentals-346323.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbt-fundamentals-346323.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-fundamentals-346323`.`jaffle_shop`.__TABLES__
        where (upper(dataset_id) = upper('jaffle_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-fundamentals-346323`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-fundamentals-346323`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
21:42:00.481941 [info ] [MainThread]: Catalog written to /Users/lizyau/code/dbt-fundamentals/target/catalog.json
21:42:00.482393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4204f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f242cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2424f0>]}
21:42:00.893011 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
21:42:00.893691 [debug] [MainThread]: Connection 'dbt-fundamentals-346323.information_schema' was properly closed.


============================== 2022-04-08 21:42:12.721851 | 003772a2-252b-476e-bc52-53952bc5e98b ==============================
21:42:12.721851 [info ] [MainThread]: Running with dbt=1.0.4
21:42:12.722859 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
21:42:12.723122 [debug] [MainThread]: Tracking: tracking
21:42:12.755813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c839a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c83a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c83d90>]}
21:42:12.758827 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
21:42:12.759187 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
21:42:12.759367 [info ] [MainThread]: 
21:42:12.759525 [info ] [MainThread]: 
21:42:12.759678 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-05-18 18:11:48.897669 | f59876d0-c269-4135-b4ce-bf6539221044 ==============================
18:11:48.897669 [info ] [MainThread]: Running with dbt=1.0.4
18:11:48.898980 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:11:48.899480 [debug] [MainThread]: Tracking: tracking
18:11:48.931383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab0970>]}
18:11:48.947640 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:11:48.947909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f59876d0-c269-4135-b4ce-bf6539221044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac2520>]}
18:11:48.960334 [debug] [MainThread]: Parsing macros/etc.sql
18:11:48.962068 [debug] [MainThread]: Parsing macros/catalog.sql
18:11:48.966714 [debug] [MainThread]: Parsing macros/adapters.sql
18:11:48.982276 [debug] [MainThread]: Parsing macros/materializations/seed.sql
18:11:48.983994 [debug] [MainThread]: Parsing macros/materializations/view.sql
18:11:48.985843 [debug] [MainThread]: Parsing macros/materializations/table.sql
18:11:48.988397 [debug] [MainThread]: Parsing macros/materializations/copy.sql
18:11:48.990052 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
18:11:48.999867 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
18:11:49.000876 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:11:49.003271 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:11:49.004701 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:11:49.005735 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:11:49.016715 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:11:49.024545 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:11:49.032824 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:11:49.035730 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:11:49.036891 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:11:49.038036 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:11:49.040848 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:11:49.048520 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:11:49.049476 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:11:49.056307 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:11:49.067359 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:11:49.072565 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:11:49.074332 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:11:49.079439 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:11:49.080225 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:11:49.081933 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:11:49.083321 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:11:49.087279 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:11:49.098485 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:11:49.099393 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:11:49.100903 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:11:49.101848 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:11:49.102383 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:11:49.102698 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:11:49.103109 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:11:49.103954 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:11:49.106719 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:11:49.112272 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:11:49.113578 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:11:49.115198 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:11:49.121286 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:11:49.123061 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:11:49.125827 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:11:49.130462 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:11:49.136798 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:11:49.266101 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
18:11:49.273830 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
18:11:49.275420 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
18:11:49.292097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f59876d0-c269-4135-b4ce-bf6539221044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec28f40>]}
18:11:49.296708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f59876d0-c269-4135-b4ce-bf6539221044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec28df0>]}
18:11:49.296906 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:11:49.297848 [info ] [MainThread]: 
18:11:49.298174 [debug] [MainThread]: Acquiring new bigquery connection "master"
18:11:49.298808 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323"
18:11:49.298971 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:11:50.130301 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
18:11:50.130964 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:11:50.797225 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
18:11:50.798156 [info ] [MainThread]: 
18:11:50.806571 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
18:11:50.806873 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
18:11:50.807370 [info ] [Thread-1  ]: 1 of 3 START view model jaffle_shop.stg_customers............................... [RUN]
18:11:50.807856 [info ] [Thread-2  ]: 2 of 3 START view model jaffle_shop.stg_orders.................................. [RUN]
18:11:50.808547 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
18:11:50.809072 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
18:11:50.809278 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
18:11:50.809466 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
18:11:50.809731 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
18:11:50.809912 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
18:11:50.812179 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
18:11:50.813709 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
18:11:50.814776 [debug] [Thread-1  ]: finished collecting timing info
18:11:50.814923 [debug] [Thread-2  ]: finished collecting timing info
18:11:50.815116 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
18:11:50.815272 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
18:11:50.846140 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
18:11:50.847626 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
18:11:50.848379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:11:50.848490 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:11:50.849545 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  OPTIONS()
  as with customers as  (
    select 
        id as customer_id,
        first_name,
        last_name
    from dbt-fundamentals-346323.jaffle_shop.customers
)

select * from customers;


18:11:50.850400 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from dbt-fundamentals-346323.jaffle_shop.orders

)

select * from orders;


18:11:52.524721 [debug] [Thread-1  ]: finished collecting timing info
18:11:52.525709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59876d0-c269-4135-b4ce-bf6539221044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed8df40>]}
18:11:52.526319 [info ] [Thread-1  ]: 1 of 3 OK created view model jaffle_shop.stg_customers.......................... [[32mOK[0m in 1.72s]
18:11:52.527243 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
18:11:52.804107 [debug] [Thread-2  ]: finished collecting timing info
18:11:52.805236 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59876d0-c269-4135-b4ce-bf6539221044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebfbeb0>]}
18:11:52.805928 [info ] [Thread-2  ]: 2 of 3 OK created view model jaffle_shop.stg_orders............................. [[32mOK[0m in 2.00s]
18:11:52.806475 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
18:11:52.807676 [debug] [Thread-4  ]: Began running node model.jaffle_shop.dim_customers
18:11:52.808047 [info ] [Thread-4  ]: 3 of 3 START table model jaffle_shop.dim_customers.............................. [RUN]
18:11:52.808670 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
18:11:52.808881 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.dim_customers
18:11:52.809099 [debug] [Thread-4  ]: Compiling model.jaffle_shop.dim_customers
18:11:52.813995 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
18:11:52.814998 [debug] [Thread-4  ]: finished collecting timing info
18:11:52.815192 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.dim_customers
18:11:52.827512 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:11:53.581382 [debug] [Thread-4  ]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
18:11:53.582120 [debug] [Thread-4  ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `dbt-fundamentals-346323`.`jaffle_shop`.`dim_customers`
  
  
  OPTIONS()
  as (
    -- CTE is common table expression
with customers as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
),

orders as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
),


customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
  
18:12:00.612933 [debug] [Thread-4  ]: finished collecting timing info
18:12:00.614188 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59876d0-c269-4135-b4ce-bf6539221044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed8e6d0>]}
18:12:00.614850 [info ] [Thread-4  ]: 3 of 3 OK created table model jaffle_shop.dim_customers......................... [[32mCREATE TABLE (100.0 rows, 4.3 KB processed)[0m in 7.81s]
18:12:00.615381 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.dim_customers
18:12:00.617783 [debug] [MainThread]: Acquiring new bigquery connection "master"
18:12:00.618475 [info ] [MainThread]: 
18:12:00.618867 [info ] [MainThread]: Finished running 2 view models, 1 table model in 11.32s.
18:12:00.619211 [debug] [MainThread]: Connection 'master' was properly closed.
18:12:00.619397 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
18:12:00.619560 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
18:12:00.619719 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
18:12:00.634541 [info ] [MainThread]: 
18:12:00.634903 [info ] [MainThread]: [32mCompleted successfully[0m
18:12:00.635178 [info ] [MainThread]: 
18:12:00.635401 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
18:12:00.635728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec1fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec1f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed8e310>]}


============================== 2022-05-18 19:09:59.259454 | 05da78b1-c0a4-4830-91ea-bd8addbd1b85 ==============================
19:09:59.259454 [info ] [MainThread]: Running with dbt=1.0.4
19:09:59.260424 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_customers+'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:09:59.260838 [debug] [MainThread]: Tracking: tracking
19:09:59.283340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1bf070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1bffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1bf2e0>]}
19:09:59.312974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
19:09:59.313264 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/core/fct_orders.sql
19:09:59.313392 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stripe/stg_payments.sql
19:09:59.313550 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
19:09:59.313685 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_customers.sql
19:09:59.326150 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
19:09:59.335382 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
19:09:59.337383 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payments.sql
19:09:59.339365 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
19:09:59.341055 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
19:09:59.342119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2e71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2d9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f276d30>]}


============================== 2022-05-18 19:11:11.437400 | 39b730ac-0c5d-4eba-92ac-4ca33ec39db2 ==============================
19:11:11.437400 [info ] [MainThread]: Running with dbt=1.0.4
19:11:11.442100 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_customers+'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:11:11.442315 [debug] [MainThread]: Tracking: tracking
19:11:11.463909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5592e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e559ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e559250>]}
19:11:11.490978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
19:11:11.491270 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/core/fct_orders.sql
19:11:11.491399 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stripe/stg_payments.sql
19:11:11.491552 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
19:11:11.491684 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_customers.sql
19:11:11.500129 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
19:11:11.509324 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
19:11:11.511194 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payments.sql
19:11:11.512880 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
19:11:11.514261 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
19:11:11.515319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6b8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e626d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6b2dc0>]}


============================== 2022-05-18 19:11:21.299215 | f294726a-7deb-4b60-a01f-882ae207541a ==============================
19:11:21.299215 [info ] [MainThread]: Running with dbt=1.0.4
19:11:21.300081 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_customers+'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:11:21.300686 [debug] [MainThread]: Tracking: tracking
19:11:21.325118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111207040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111207550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112073a0>]}
19:11:21.353673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
19:11:21.354008 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/core/fct_orders.sql
19:11:21.354147 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stripe/stg_payments.sql
19:11:21.354314 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_customers.sql
19:11:21.354475 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/dim_customers.sql
19:11:21.362001 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
19:11:21.371070 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
19:11:21.372179 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payments.sql
19:11:21.373649 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
19:11:21.375118 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
19:11:21.382351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f294726a-7deb-4b60-a01f-882ae207541a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113530d0>]}
19:11:21.386559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f294726a-7deb-4b60-a01f-882ae207541a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d1d30>]}
19:11:21.386750 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:11:21.387710 [info ] [MainThread]: 
19:11:21.388021 [debug] [MainThread]: Acquiring new bigquery connection "master"
19:11:21.388535 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323"
19:11:21.388707 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:11:22.210791 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
19:11:22.211027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:11:22.943836 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
19:11:22.944618 [info ] [MainThread]: 
19:11:22.952332 [debug] [Thread-1  ]: Began running node model.jaffle_shop.dim_customers
19:11:22.952886 [info ] [Thread-1  ]: 1 of 1 START table model jaffle_shop.dim_customers.............................. [RUN]
19:11:22.953726 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
19:11:22.953969 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.dim_customers
19:11:22.954225 [debug] [Thread-1  ]: Compiling model.jaffle_shop.dim_customers
19:11:22.958782 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
19:11:22.960128 [debug] [Thread-1  ]: finished collecting timing info
19:11:22.960350 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.dim_customers
19:11:22.976149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:11:23.567844 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
19:11:23.568958 [debug] [Thread-1  ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `dbt-fundamentals-346323`.`jaffle_shop`.`dim_customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`

),

orders as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`

),

payments as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
  
19:11:23.830792 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `dbt-fundamentals-346323`.`jaffle_shop`.`dim_customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`

),

orders as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`

),

payments as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
  
19:11:23.832353 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table dbt-fundamentals-346323:jaffle_shop.stg_payments was not found in location US

(job ID: cfc150ea-1a0b-46e9-aad5-f51a15d3e7c3)

                                                          -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
   2:
   3:
   4:  create or replace table `dbt-fundamentals-346323`.`jaffle_shop`.`dim_customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with customers as (
  10:
  11:    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  12:
  13:),
  14:
  15:orders as (
  16:
  17:    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  18:
  19:),
  20:
  21:payments as (
  22:
  23:    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
  24:
  25:),
  26:
  27:customer_orders as (
  28:
  29:    select
  30:        customer_id,
  31:
  32:        min(order_date) as first_order,
  33:        max(order_date) as most_recent_order,
  34:        count(order_id) as number_of_orders
  35:    from orders
  36:
  37:    group by customer_id
  38:
  39:),
  40:
  41:customer_payments as (
  42:
  43:    select
  44:        orders.customer_id,
  45:        sum(amount) as total_amount
  46:
  47:    from payments
  48:
  49:    left join orders on
  50:         payments.order_id = orders.order_id
  51:
  52:    group by orders.customer_id
  53:
  54:),
  55:
  56:final as (
  57:
  58:    select
  59:        customers.customer_id,
  60:        customers.first_name,
  61:        customers.last_name,
  62:        customer_orders.first_order,
  63:        customer_orders.most_recent_order,
  64:        customer_orders.number_of_orders,
  65:        customer_payments.total_amount as customer_lifetime_value
  66:
  67:    from customers
  68:
  69:    left join customer_orders
  70:        on customers.customer_id = customer_orders.customer_id
  71:
  72:    left join customer_payments
  73:        on  customers.customer_id = customer_payments.customer_id
  74:
  75:)
  76:
  77:select * from final
  78:  );
  79:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
19:11:23.833162 [debug] [Thread-1  ]: finished collecting timing info
19:11:23.833912 [debug] [Thread-1  ]: Runtime Error in model dim_customers (models/marts/core/dim_customers.sql)
  404 Not found: Table dbt-fundamentals-346323:jaffle_shop.stg_payments was not found in location US
  
  (job ID: cfc150ea-1a0b-46e9-aad5-f51a15d3e7c3)
19:11:23.834519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f294726a-7deb-4b60-a01f-882ae207541a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111506130>]}
19:11:23.835246 [error] [Thread-1  ]: 1 of 1 ERROR creating table model jaffle_shop.dim_customers..................... [[31mERROR[0m in 0.88s]
19:11:23.837509 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.dim_customers
19:11:23.839935 [debug] [MainThread]: Acquiring new bigquery connection "master"
19:11:23.840466 [info ] [MainThread]: 
19:11:23.840824 [info ] [MainThread]: Finished running 1 table model in 2.45s.
19:11:23.841156 [debug] [MainThread]: Connection 'master' was properly closed.
19:11:23.841338 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
19:11:23.850276 [info ] [MainThread]: 
19:11:23.850689 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:11:23.851017 [info ] [MainThread]: 
19:11:23.851284 [error] [MainThread]: [33mRuntime Error in model dim_customers (models/marts/core/dim_customers.sql)[0m
19:11:23.851536 [error] [MainThread]:   404 Not found: Table dbt-fundamentals-346323:jaffle_shop.stg_payments was not found in location US
19:11:23.851771 [error] [MainThread]:   
19:11:23.851968 [error] [MainThread]:   (job ID: cfc150ea-1a0b-46e9-aad5-f51a15d3e7c3)
19:11:23.852177 [info ] [MainThread]: 
19:11:23.852411 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
19:11:23.852741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111446fa0>]}


============================== 2022-05-18 19:12:11.130429 | 7d7db469-e359-44ed-bfd4-7dae38b6e656 ==============================
19:12:11.130429 [info ] [MainThread]: Running with dbt=1.0.4
19:12:11.131103 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_payments'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:12:11.131536 [debug] [MainThread]: Tracking: tracking
19:12:11.150047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1a9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1a96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1a95b0>]}
19:12:11.173197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:12:11.173405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:12:11.177350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d7db469-e359-44ed-bfd4-7dae38b6e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2f70d0>]}
19:12:11.181839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d7db469-e359-44ed-bfd4-7dae38b6e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b3880>]}
19:12:11.182075 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:12:11.183084 [info ] [MainThread]: 
19:12:11.183429 [debug] [MainThread]: Acquiring new bigquery connection "master"
19:12:11.184033 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323"
19:12:11.184270 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:12:11.877108 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
19:12:11.877759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:12:12.557833 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
19:12:12.558672 [info ] [MainThread]: 
19:12:12.566865 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_payments
19:12:12.569214 [info ] [Thread-1  ]: 1 of 1 START view model jaffle_shop.stg_payments................................ [RUN]
19:12:12.569785 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
19:12:12.569956 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_payments
19:12:12.570169 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_payments
19:12:12.571853 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
19:12:12.574401 [debug] [Thread-1  ]: finished collecting timing info
19:12:12.574602 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_payments
19:12:12.600751 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
19:12:12.601295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:12:12.602334 [debug] [Thread-1  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
  OPTIONS()
  as with source as (

    select * from dbt-fundamentals-346323.jaffle_shop.payments

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


19:12:13.790115 [debug] [Thread-1  ]: finished collecting timing info
19:12:13.790575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d7db469-e359-44ed-bfd4-7dae38b6e656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3d1040>]}
19:12:13.790853 [info ] [Thread-1  ]: 1 of 1 OK created view model jaffle_shop.stg_payments........................... [[32mOK[0m in 1.22s]
19:12:13.791111 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_payments
19:12:13.792147 [debug] [MainThread]: Acquiring new bigquery connection "master"
19:12:13.792453 [info ] [MainThread]: 
19:12:13.792650 [info ] [MainThread]: Finished running 1 view model in 2.61s.
19:12:13.792838 [debug] [MainThread]: Connection 'master' was properly closed.
19:12:13.792935 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
19:12:13.796759 [info ] [MainThread]: 
19:12:13.796983 [info ] [MainThread]: [32mCompleted successfully[0m
19:12:13.797165 [info ] [MainThread]: 
19:12:13.797520 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:12:13.797778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f274340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f39d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3a8c10>]}


============================== 2022-05-18 19:12:18.992242 | 81a14392-d11e-429a-805d-83559f7ea853 ==============================
19:12:18.992242 [info ] [MainThread]: Running with dbt=1.0.4
19:12:18.992876 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['dim_customers+'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:12:18.993288 [debug] [MainThread]: Tracking: tracking
19:12:19.010739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112806100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112806eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112806ac0>]}
19:12:19.033834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:12:19.034020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:12:19.037810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81a14392-d11e-429a-805d-83559f7ea853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129410d0>]}
19:12:19.043181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81a14392-d11e-429a-805d-83559f7ea853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128be700>]}
19:12:19.043441 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:12:19.044447 [info ] [MainThread]: 
19:12:19.044813 [debug] [MainThread]: Acquiring new bigquery connection "master"
19:12:19.045435 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323"
19:12:19.045653 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:12:19.606372 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
19:12:19.607006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:12:20.160678 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
19:12:20.161564 [info ] [MainThread]: 
19:12:20.170721 [debug] [Thread-1  ]: Began running node model.jaffle_shop.dim_customers
19:12:20.173380 [info ] [Thread-1  ]: 1 of 1 START table model jaffle_shop.dim_customers.............................. [RUN]
19:12:20.174006 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
19:12:20.174245 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.dim_customers
19:12:20.174535 [debug] [Thread-1  ]: Compiling model.jaffle_shop.dim_customers
19:12:20.181452 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
19:12:20.182257 [debug] [Thread-1  ]: finished collecting timing info
19:12:20.182426 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.dim_customers
19:12:20.197187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:12:20.844759 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
19:12:20.845391 [debug] [Thread-1  ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `dbt-fundamentals-346323`.`jaffle_shop`.`dim_customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`

),

orders as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`

),

payments as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
  
19:12:25.839996 [debug] [Thread-1  ]: finished collecting timing info
19:12:25.841145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a14392-d11e-429a-805d-83559f7ea853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a69ac0>]}
19:12:25.841535 [info ] [Thread-1  ]: 1 of 1 OK created table model jaffle_shop.dim_customers......................... [[32mCREATE TABLE (100.0 rows, 6.0 KB processed)[0m in 5.67s]
19:12:25.841760 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.dim_customers
19:12:25.842820 [debug] [MainThread]: Acquiring new bigquery connection "master"
19:12:25.843033 [info ] [MainThread]: 
19:12:25.843170 [info ] [MainThread]: Finished running 1 table model in 6.80s.
19:12:25.843312 [debug] [MainThread]: Connection 'master' was properly closed.
19:12:25.843389 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
19:12:25.846834 [info ] [MainThread]: 
19:12:25.847063 [info ] [MainThread]: [32mCompleted successfully[0m
19:12:25.847250 [info ] [MainThread]: 
19:12:25.847449 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:12:25.847722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f2070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112910ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f1c70>]}


============================== 2022-05-18 20:12:23.739028 | 1214149a-df6f-42cf-985e-d9c23dc981e0 ==============================
20:12:23.739028 [info ] [MainThread]: Running with dbt=1.0.4
20:12:23.740231 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:12:23.740551 [debug] [MainThread]: Tracking: tracking
20:12:23.766099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ece20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128dc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf5640>]}
20:12:23.787177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ea580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11295a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11295a340>]}


============================== 2022-05-18 20:13:43.860788 | fd5e4d90-b003-456f-8d81-d3e4ed7df877 ==============================
20:13:43.860788 [info ] [MainThread]: Running with dbt=1.0.4
20:13:43.861825 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:13:43.862061 [debug] [MainThread]: Tracking: tracking
20:13:43.881483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111488e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114883a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111488790>]}
20:13:43.900011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11149c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a5dc0>]}


============================== 2022-05-18 20:14:19.840785 | 90e3b545-83f0-4376-9417-c2e80bc94f7b ==============================
20:14:19.840785 [info ] [MainThread]: Running with dbt=1.0.4
20:14:19.843221 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:14:19.843918 [debug] [MainThread]: Tracking: tracking
20:14:19.866953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111eedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111eec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111ee5b0>]}
20:14:19.886154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f63d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130bbb0>]}


============================== 2022-05-18 20:14:43.753953 | a7725895-809e-4cf4-9d94-1868d214067d ==============================
20:14:43.753953 [info ] [MainThread]: Running with dbt=1.0.4
20:14:43.754870 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:14:43.755440 [debug] [MainThread]: Tracking: tracking
20:14:43.775376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107167c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110716a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110716c10>]}
20:14:43.793738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110729340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110833a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110833b80>]}


============================== 2022-05-18 20:17:14.133128 | b0f56655-55f2-4270-a668-69994a1adbbc ==============================
20:17:14.133128 [info ] [MainThread]: Running with dbt=1.0.4
20:17:14.134012 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:17:14.134453 [debug] [MainThread]: Tracking: tracking
20:17:14.155077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ac130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eca6730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ace80>]}
20:17:14.174768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109efa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ef970>]}


============================== 2022-05-18 20:19:11.948666 | a7c3e93b-a2bc-4417-918d-54ea1da25505 ==============================
20:19:11.948666 [info ] [MainThread]: Running with dbt=1.0.4
20:19:11.949520 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:19:11.950019 [debug] [MainThread]: Tracking: tracking
20:19:11.970369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d2b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d2580>]}
20:19:11.989535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0e59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1efa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1efbb0>]}


============================== 2022-05-18 20:21:10.530694 | 5788d3e5-7450-4c5b-89cd-a6830fe987a9 ==============================
20:21:10.530694 [info ] [MainThread]: Running with dbt=1.0.4
20:21:10.531797 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:21:10.532012 [debug] [MainThread]: Tracking: tracking
20:21:10.552439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f20fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f20f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f20f250>]}
20:21:10.571123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f32da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ea100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ea2e0>]}


============================== 2022-05-18 20:23:26.471060 | 81329149-0081-41ea-85a2-4d961acb2595 ==============================
20:23:26.471060 [info ] [MainThread]: Running with dbt=1.0.4
20:23:26.471840 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:23:26.472254 [debug] [MainThread]: Tracking: tracking
20:23:26.493135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d1a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ed790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d1aaf0>]}
20:23:26.513727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d19910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112df3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112df3370>]}


============================== 2022-05-18 20:26:05.498956 | 907a1bb1-0cc9-4e8b-9cb6-4897174be2b5 ==============================
20:26:05.498956 [info ] [MainThread]: Running with dbt=1.0.4
20:26:05.499945 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:26:05.500394 [debug] [MainThread]: Tracking: tracking
20:26:05.520545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3964c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f396f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f396d00>]}
20:26:05.541834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b0fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b6850>]}


============================== 2022-05-18 20:27:11.429872 | 77d5110e-92d2-4196-9c53-41f90e39eb3f ==============================
20:27:11.429872 [info ] [MainThread]: Running with dbt=1.0.4
20:27:11.430950 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:27:11.431124 [debug] [MainThread]: Tracking: tracking
20:27:11.450804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de4490>]}
20:27:11.478229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
20:27:11.478578 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
20:27:11.478783 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stripe/src_stripe.yml
20:27:11.478977 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_orders.sql
20:27:11.479120 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stripe/stg_payments.sql
20:27:11.479259 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_customers.sql
20:27:11.487726 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
20:27:11.495442 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payments.sql
20:27:11.496788 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
20:27:11.513868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77d5110e-92d2-4196-9c53-41f90e39eb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc00a0>]}
20:27:11.518704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77d5110e-92d2-4196-9c53-41f90e39eb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed07f0>]}
20:27:11.518891 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:27:11.519895 [info ] [MainThread]: 
20:27:11.520204 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:27:11.520924 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323"
20:27:11.521102 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:27:12.317165 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
20:27:12.317886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:27:13.027890 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
20:27:13.028767 [info ] [MainThread]: 
20:27:13.037248 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
20:27:13.037485 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
20:27:13.037820 [debug] [Thread-3  ]: Began running node model.jaffle_shop.stg_payments
20:27:13.038261 [info ] [Thread-1  ]: 1 of 5 START view model jaffle_shop.stg_customers............................... [RUN]
20:27:13.038595 [info ] [Thread-2  ]: 2 of 5 START view model jaffle_shop.stg_orders.................................. [RUN]
20:27:13.038873 [info ] [Thread-3  ]: 3 of 5 START view model jaffle_shop.stg_payments................................ [RUN]
20:27:13.039433 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
20:27:13.040669 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
20:27:13.041447 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
20:27:13.041684 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
20:27:13.041893 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
20:27:13.042049 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.stg_payments
20:27:13.042268 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
20:27:13.042417 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
20:27:13.042551 [debug] [Thread-3  ]: Compiling model.jaffle_shop.stg_payments
20:27:13.047896 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
20:27:13.051306 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
20:27:13.054265 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
20:27:13.054750 [debug] [Thread-3  ]: finished collecting timing info
20:27:13.054883 [debug] [Thread-2  ]: finished collecting timing info
20:27:13.055091 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.stg_payments
20:27:13.055200 [debug] [Thread-1  ]: finished collecting timing info
20:27:13.055335 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
20:27:13.080011 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
20:27:13.082867 [debug] [Thread-3  ]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
20:27:13.084704 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
20:27:13.086189 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
20:27:13.086655 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:27:13.086772 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:27:13.086886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:13.087885 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
  OPTIONS()
  as with source as (

    select * from `dbt-fundamentals-346323`.`stripe`.`payments`

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


20:27:13.088678 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`}

)

select * from orders;


20:27:13.089446 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  OPTIONS()
  as with customers as (
    select
        id as customer_id,
        first_name,
        last_name
    from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
)

select * from customers;


20:27:13.858526 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "}" at [14:58]')
20:27:14.307603 [debug] [Thread-3  ]: finished collecting timing info
20:27:14.309722 [debug] [Thread-1  ]: finished collecting timing info
20:27:14.310510 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77d5110e-92d2-4196-9c53-41f90e39eb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ad940>]}
20:27:14.310917 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77d5110e-92d2-4196-9c53-41f90e39eb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111149e80>]}
20:27:14.311460 [info ] [Thread-3  ]: 3 of 5 OK created view model jaffle_shop.stg_payments........................... [[32mOK[0m in 1.27s]
20:27:14.311830 [info ] [Thread-1  ]: 1 of 5 OK created view model jaffle_shop.stg_customers.......................... [[32mOK[0m in 1.27s]
20:27:14.312220 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.stg_payments
20:27:14.312491 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
20:27:15.096806 [debug] [Thread-2  ]: finished collecting timing info
20:27:15.098272 [debug] [Thread-2  ]: Database Error in model stg_orders (models/staging/jaffle_shop/stg_orders.sql)
  Syntax error: Expected ")" but got "}" at [14:58]
  compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_orders.sql
20:27:15.098907 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77d5110e-92d2-4196-9c53-41f90e39eb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111193490>]}
20:27:15.099564 [error] [Thread-2  ]: 2 of 5 ERROR creating view model jaffle_shop.stg_orders......................... [[31mERROR[0m in 2.06s]
20:27:15.100119 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
20:27:15.101419 [debug] [Thread-5  ]: Began running node model.jaffle_shop.dim_customers
20:27:15.101710 [debug] [Thread-6  ]: Began running node model.jaffle_shop.fct_orders
20:27:15.102046 [info ] [Thread-5  ]: 4 of 5 SKIP relation jaffle_shop.dim_customers.................................. [[33mSKIP[0m]
20:27:15.102269 [info ] [Thread-6  ]: 5 of 5 SKIP relation jaffle_shop.fct_orders..................................... [[33mSKIP[0m]
20:27:15.102632 [debug] [Thread-5  ]: Finished running node model.jaffle_shop.dim_customers
20:27:15.103084 [debug] [Thread-6  ]: Finished running node model.jaffle_shop.fct_orders
20:27:15.105126 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:27:15.105676 [info ] [MainThread]: 
20:27:15.106035 [info ] [MainThread]: Finished running 3 view models, 2 table models in 3.59s.
20:27:15.106376 [debug] [MainThread]: Connection 'master' was properly closed.
20:27:15.106557 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
20:27:15.106717 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
20:27:15.106874 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
20:27:15.115145 [info ] [MainThread]: 
20:27:15.115610 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:27:15.115887 [info ] [MainThread]: 
20:27:15.116122 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/staging/jaffle_shop/stg_orders.sql)[0m
20:27:15.116339 [error] [MainThread]:   Syntax error: Expected ")" but got "}" at [14:58]
20:27:15.116547 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_orders.sql
20:27:15.116766 [info ] [MainThread]: 
20:27:15.116986 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
20:27:15.117407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11114c7f0>]}


============================== 2022-05-18 20:38:40.593634 | 8e55af5c-7208-4a69-9f9a-34e29504ef00 ==============================
20:38:40.593634 [info ] [MainThread]: Running with dbt=1.0.4
20:38:40.594448 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:38:40.594918 [debug] [MainThread]: Tracking: tracking
20:38:40.617839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ceb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ceb6d0>]}
20:38:40.646543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:38:40.646916 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_orders.sql
20:38:40.656607 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
20:38:40.669812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e55af5c-7208-4a69-9f9a-34e29504ef00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a760d0>]}
20:38:40.674571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e55af5c-7208-4a69-9f9a-34e29504ef00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a04f70>]}
20:38:40.674770 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:38:40.675820 [info ] [MainThread]: 
20:38:40.676151 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:38:40.676974 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323"
20:38:40.677197 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:38:41.444701 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
20:38:41.445446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:38:42.154735 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
20:38:42.155220 [info ] [MainThread]: 
20:38:42.160337 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
20:38:42.160529 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
20:38:42.160813 [info ] [Thread-1  ]: 1 of 5 START view model jaffle_shop.stg_customers............................... [RUN]
20:38:42.160947 [debug] [Thread-3  ]: Began running node model.jaffle_shop.stg_payments
20:38:42.161137 [info ] [Thread-2  ]: 2 of 5 START view model jaffle_shop.stg_orders.................................. [RUN]
20:38:42.161537 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
20:38:42.161724 [info ] [Thread-3  ]: 3 of 5 START view model jaffle_shop.stg_payments................................ [RUN]
20:38:42.162082 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
20:38:42.162355 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
20:38:42.162842 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
20:38:42.162998 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
20:38:42.163182 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
20:38:42.163318 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.stg_payments
20:38:42.163451 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
20:38:42.165894 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
20:38:42.166080 [debug] [Thread-3  ]: Compiling model.jaffle_shop.stg_payments
20:38:42.168302 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
20:38:42.170627 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
20:38:42.171300 [debug] [Thread-1  ]: finished collecting timing info
20:38:42.171577 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
20:38:42.171715 [debug] [Thread-2  ]: finished collecting timing info
20:38:42.177718 [debug] [Thread-3  ]: finished collecting timing info
20:38:42.195479 [debug] [Thread-1  ]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
20:38:42.195656 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
20:38:42.195778 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.stg_payments
20:38:42.198992 [debug] [Thread-3  ]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
20:38:42.199141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:38:42.200553 [debug] [Thread-2  ]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
20:38:42.201714 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  OPTIONS()
  as with customers as (
    select
        id as customer_id,
        first_name,
        last_name
    from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
)

select * from customers;


20:38:42.201996 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:38:42.202092 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:38:42.233149 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
  OPTIONS()
  as with source as (

    select * from `dbt-fundamentals-346323`.`stripe`.`payments`

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


20:38:42.265349 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`

)

select * from orders;


20:38:43.263114 [debug] [Thread-2  ]: finished collecting timing info
20:38:43.264014 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e55af5c-7208-4a69-9f9a-34e29504ef00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a5b130>]}
20:38:43.264541 [info ] [Thread-2  ]: 2 of 5 OK created view model jaffle_shop.stg_orders............................. [[32mOK[0m in 1.10s]
20:38:43.266436 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
20:38:43.363071 [debug] [Thread-3  ]: finished collecting timing info
20:38:43.363885 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e55af5c-7208-4a69-9f9a-34e29504ef00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c0beb0>]}
20:38:43.364330 [info ] [Thread-3  ]: 3 of 5 OK created view model jaffle_shop.stg_payments........................... [[32mOK[0m in 1.20s]
20:38:43.364659 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.stg_payments
20:38:43.365201 [debug] [Thread-5  ]: Began running node model.jaffle_shop.fct_orders
20:38:43.365499 [info ] [Thread-5  ]: 4 of 5 START table model jaffle_shop.fct_orders................................. [RUN]
20:38:43.365943 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.jaffle_shop.fct_orders"
20:38:43.366096 [debug] [Thread-5  ]: Began compiling node model.jaffle_shop.fct_orders
20:38:43.366251 [debug] [Thread-5  ]: Compiling model.jaffle_shop.fct_orders
20:38:43.370829 [debug] [Thread-5  ]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
20:38:43.371314 [debug] [Thread-5  ]: finished collecting timing info
20:38:43.371458 [debug] [Thread-5  ]: Began executing node model.jaffle_shop.fct_orders
20:38:43.391066 [debug] [Thread-5  ]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
20:38:43.391560 [debug] [Thread-5  ]: Opening a new connection, currently in state init
20:38:43.392668 [debug] [Thread-5  ]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `dbt-fundamentals-346323`.`jaffle_shop`.`fct_orders`
  
  
  OPTIONS()
  as (
    

with orders as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`

),

payments as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
  
20:38:43.587910 [debug] [Thread-1  ]: finished collecting timing info
20:38:43.588411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e55af5c-7208-4a69-9f9a-34e29504ef00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc5fd0>]}
20:38:43.588715 [info ] [Thread-1  ]: 1 of 5 OK created view model jaffle_shop.stg_customers.......................... [[32mOK[0m in 1.43s]
20:38:43.588961 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
20:38:43.589320 [debug] [Thread-4  ]: Began running node model.jaffle_shop.dim_customers
20:38:43.589546 [info ] [Thread-4  ]: 5 of 5 START table model jaffle_shop.dim_customers.............................. [RUN]
20:38:43.589920 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
20:38:43.590049 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.dim_customers
20:38:43.590172 [debug] [Thread-4  ]: Compiling model.jaffle_shop.dim_customers
20:38:43.592782 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
20:38:43.594228 [debug] [Thread-4  ]: finished collecting timing info
20:38:43.594404 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.dim_customers
20:38:43.595827 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:38:44.251368 [debug] [Thread-4  ]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
20:38:44.254066 [debug] [Thread-4  ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `dbt-fundamentals-346323`.`jaffle_shop`.`dim_customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`

),

orders as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`

),

payments as (

    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
  
20:38:47.195180 [debug] [Thread-5  ]: finished collecting timing info
20:38:47.195941 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e55af5c-7208-4a69-9f9a-34e29504ef00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c30730>]}
20:38:47.196396 [info ] [Thread-5  ]: 4 of 5 OK created table model jaffle_shop.fct_orders............................ [[32mCREATE TABLE (99.0 rows, 6.5 KB processed)[0m in 3.83s]
20:38:47.197111 [debug] [Thread-5  ]: Finished running node model.jaffle_shop.fct_orders
20:38:48.735901 [debug] [Thread-4  ]: finished collecting timing info
20:38:48.736877 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e55af5c-7208-4a69-9f9a-34e29504ef00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb4a00>]}
20:38:48.737455 [info ] [Thread-4  ]: 5 of 5 OK created table model jaffle_shop.dim_customers......................... [[32mCREATE TABLE (100.0 rows, 6.0 KB processed)[0m in 5.15s]
20:38:48.737829 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.dim_customers
20:38:48.739545 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:38:48.739990 [info ] [MainThread]: 
20:38:48.740300 [info ] [MainThread]: Finished running 3 view models, 2 table models in 8.06s.
20:38:48.740585 [debug] [MainThread]: Connection 'master' was properly closed.
20:38:48.740739 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
20:38:48.740878 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
20:38:48.741018 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
20:38:48.741154 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
20:38:48.741288 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
20:38:48.748226 [info ] [MainThread]: 
20:38:48.748539 [info ] [MainThread]: [32mCompleted successfully[0m
20:38:48.748821 [info ] [MainThread]: 
20:38:48.749051 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
20:38:48.749391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128bb4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129fa100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c3a070>]}


============================== 2022-05-19 21:50:18.770035 | 0848b027-7762-46a5-a5d3-10750c72cb11 ==============================
21:50:18.770035 [info ] [MainThread]: Running with dbt=1.0.4
21:50:18.770943 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_customers'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
21:50:18.771337 [debug] [MainThread]: Tracking: tracking
21:50:18.796889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6ac1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6ac6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6ac7f0>]}
21:50:18.827616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
21:50:18.827970 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
21:50:18.854673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0848b027-7762-46a5-a5d3-10750c72cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e83e0d0>]}
21:50:18.859148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0848b027-7762-46a5-a5d3-10750c72cb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7c3d00>]}
21:50:18.859341 [info ] [MainThread]: Found 5 models, 2 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
21:50:18.860344 [info ] [MainThread]: 
21:50:18.860669 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:50:18.861693 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:50:18.861875 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:50:19.969663 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:50:19.970451 [info ] [MainThread]: 
21:50:19.976749 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:19.976946 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:19.977186 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_customers_customer_id............................ [RUN]
21:50:19.977483 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_customers_customer_id.............................. [RUN]
21:50:19.978108 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
21:50:19.978799 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
21:50:19.979043 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:19.979290 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:19.979554 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:19.979940 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:19.991221 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
21:50:19.997149 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
21:50:19.998647 [debug] [Thread-2  ]: finished collecting timing info
21:50:19.998823 [debug] [Thread-1  ]: finished collecting timing info
21:50:19.999079 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:19.999277 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:20.016828 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
21:50:20.019663 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
21:50:20.019968 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:50:20.020181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:50:20.021213 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
21:50:20.054489 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
21:50:21.737024 [debug] [Thread-1  ]: finished collecting timing info
21:50:21.737981 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_customers_customer_id.................................. [[32mPASS[0m in 1.76s]
21:50:21.740853 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:22.100014 [debug] [Thread-2  ]: finished collecting timing info
21:50:22.101138 [info ] [Thread-2  ]: 2 of 2 PASS unique_stg_customers_customer_id.................................... [[32mPASS[0m in 2.12s]
21:50:22.101642 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:22.103940 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:50:22.104587 [info ] [MainThread]: 
21:50:22.104989 [info ] [MainThread]: Finished running 2 tests in 3.24s.
21:50:22.105336 [debug] [MainThread]: Connection 'master' was properly closed.
21:50:22.105523 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
21:50:22.105689 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
21:50:22.117714 [info ] [MainThread]: 
21:50:22.118127 [info ] [MainThread]: [32mCompleted successfully[0m
21:50:22.118416 [info ] [MainThread]: 
21:50:22.118681 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
21:50:22.119078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e820b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e820e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7c3250>]}


============================== 2022-05-19 21:50:45.347238 | 307e81e2-7c80-4224-80a6-abc593d159b5 ==============================
21:50:45.347238 [info ] [MainThread]: Running with dbt=1.0.4
21:50:45.347799 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_customers'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
21:50:45.348187 [debug] [MainThread]: Tracking: tracking
21:50:45.367426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f07acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f07aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f07a700>]}
21:50:45.391493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:50:45.391687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:50:45.395746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '307e81e2-7c80-4224-80a6-abc593d159b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1db0d0>]}
21:50:45.400231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '307e81e2-7c80-4224-80a6-abc593d159b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f149550>]}
21:50:45.400419 [info ] [MainThread]: Found 5 models, 2 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
21:50:45.401401 [info ] [MainThread]: 
21:50:45.401723 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:50:45.402557 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:50:45.402733 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:50:46.070201 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:50:46.072489 [info ] [MainThread]: 
21:50:46.079678 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:46.079879 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:46.080183 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_customers_customer_id............................ [RUN]
21:50:46.080447 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_customers_customer_id.............................. [RUN]
21:50:46.081173 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
21:50:46.082122 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
21:50:46.082347 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:46.082520 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:46.082947 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:46.083284 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:46.094690 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
21:50:46.100165 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
21:50:46.100626 [debug] [Thread-2  ]: finished collecting timing info
21:50:46.100731 [debug] [Thread-1  ]: finished collecting timing info
21:50:46.100866 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:46.100979 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:46.116893 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
21:50:46.118198 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
21:50:46.118590 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:50:46.118711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:50:46.119767 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
21:50:46.121472 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
21:50:47.609568 [debug] [Thread-1  ]: finished collecting timing info
21:50:47.610781 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_customers_customer_id.................................. [[32mPASS[0m in 1.53s]
21:50:47.611258 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
21:50:47.742111 [debug] [Thread-2  ]: finished collecting timing info
21:50:47.743135 [info ] [Thread-2  ]: 2 of 2 PASS unique_stg_customers_customer_id.................................... [[32mPASS[0m in 1.66s]
21:50:47.743602 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
21:50:47.746364 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:50:47.747150 [info ] [MainThread]: 
21:50:47.747589 [info ] [MainThread]: Finished running 2 tests in 2.35s.
21:50:47.747951 [debug] [MainThread]: Connection 'master' was properly closed.
21:50:47.748141 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
21:50:47.748312 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
21:50:47.756426 [info ] [MainThread]: 
21:50:47.756771 [info ] [MainThread]: [32mCompleted successfully[0m
21:50:47.757228 [info ] [MainThread]: 
21:50:47.757631 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
21:50:47.758044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f149400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1494c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f290be0>]}


============================== 2022-05-19 21:54:09.100288 | 4fe92157-b0e0-4379-8b60-b49c163ba24d ==============================
21:54:09.100288 [info ] [MainThread]: Running with dbt=1.0.4
21:54:09.110860 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
21:54:09.111236 [debug] [MainThread]: Tracking: tracking
21:54:09.135878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e43d0>]}
21:54:09.165901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:54:09.166303 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
21:54:09.191673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe92157-b0e0-4379-8b60-b49c163ba24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135930d0>]}
21:54:09.195921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe92157-b0e0-4379-8b60-b49c163ba24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113512c70>]}
21:54:09.196097 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
21:54:09.197106 [info ] [MainThread]: 
21:54:09.197423 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:54:09.198205 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:54:09.198360 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:54:10.018333 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:54:10.019673 [info ] [MainThread]: 
21:54:10.027219 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1
21:54:10.027473 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523
21:54:10.027787 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_orders_stg_orders................................ [RUN]
21:54:10.028018 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_orders_stg_orders.................................. [RUN]
21:54:10.028599 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1"
21:54:10.029240 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523"
21:54:10.029442 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1
21:54:10.029636 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523
21:54:10.029877 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1
21:54:10.030059 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523
21:54:10.042952 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1"
21:54:10.049002 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523"
21:54:10.049603 [debug] [Thread-1  ]: finished collecting timing info
21:54:10.049722 [debug] [Thread-2  ]: finished collecting timing info
21:54:10.049876 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1
21:54:10.050004 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523
21:54:10.071444 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523"
21:54:10.072924 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1"
21:54:10.073172 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:54:10.073368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:54:10.074405 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select stg_orders as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where stg_orders is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
21:54:10.075501 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where stg_orders is null



      
    ) dbt_internal_test
21:54:10.931265 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Grouping by expressions of type STRUCT is not allowed at [24:10]')
21:54:11.667082 [debug] [Thread-1  ]: finished collecting timing info
21:54:11.668291 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_orders_stg_orders...................................... [[32mPASS[0m in 1.64s]
21:54:11.668823 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1
21:54:12.210912 [debug] [Thread-2  ]: finished collecting timing info
21:54:12.212054 [debug] [Thread-2  ]: Database Error in test unique_stg_orders_stg_orders (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  Grouping by expressions of type STRUCT is not allowed at [24:10]
  compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_jaffle_shop.yml/unique_stg_orders_stg_orders.sql
21:54:12.212457 [error] [Thread-2  ]: 2 of 2 ERROR unique_stg_orders_stg_orders....................................... [[31mERROR[0m in 2.18s]
21:54:12.212945 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523
21:54:12.215390 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:54:12.215927 [info ] [MainThread]: 
21:54:12.216277 [info ] [MainThread]: Finished running 2 tests in 3.02s.
21:54:12.216614 [debug] [MainThread]: Connection 'master' was properly closed.
21:54:12.216802 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_stg_orders.d6a4acc4d1' was properly closed.
21:54:12.216969 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_stg_orders.3c8b3c4523' was properly closed.
21:54:12.225237 [info ] [MainThread]: 
21:54:12.225543 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
21:54:12.225808 [info ] [MainThread]: 
21:54:12.226029 [error] [MainThread]: [33mDatabase Error in test unique_stg_orders_stg_orders (models/staging/jaffle_shop/stg_jaffle_shop.yml)[0m
21:54:12.226241 [error] [MainThread]:   Grouping by expressions of type STRUCT is not allowed at [24:10]
21:54:12.226444 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/jaffle_shop/stg_jaffle_shop.yml/unique_stg_orders_stg_orders.sql
21:54:12.226654 [info ] [MainThread]: 
21:54:12.226870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
21:54:12.227234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113512ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113512820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136bdc70>]}


============================== 2022-05-19 21:55:59.689581 | 44d94cfe-afd3-4389-b34e-2f0d1884f314 ==============================
21:55:59.689581 [info ] [MainThread]: Running with dbt=1.0.4
21:55:59.690673 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
21:55:59.690882 [debug] [MainThread]: Tracking: tracking
21:55:59.710615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed876a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d192160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed87430>]}
21:55:59.738974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:55:59.739420 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
21:55:59.748238 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
21:55:59.773866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44d94cfe-afd3-4389-b34e-2f0d1884f314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef440d0>]}
21:55:59.777995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44d94cfe-afd3-4389-b34e-2f0d1884f314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed87700>]}
21:55:59.778175 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
21:55:59.779218 [info ] [MainThread]: 
21:55:59.779556 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:55:59.780374 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:55:59.780546 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:56:00.406901 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:56:00.407791 [info ] [MainThread]: 
21:56:00.416452 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:56:00.416710 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:56:00.417052 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_orders_order_id.................................. [RUN]
21:56:00.417318 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_orders_order_id.................................... [RUN]
21:56:00.417888 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
21:56:00.418678 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
21:56:00.418909 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:56:00.419426 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:56:00.419911 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:56:00.420145 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:56:00.435177 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
21:56:00.442196 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
21:56:00.442573 [debug] [Thread-2  ]: finished collecting timing info
21:56:00.442800 [debug] [Thread-1  ]: finished collecting timing info
21:56:00.442939 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:56:00.443078 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:56:00.460429 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
21:56:00.461759 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
21:56:00.462175 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:56:00.462305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:56:00.463394 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
21:56:00.464271 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
21:56:02.235169 [debug] [Thread-1  ]: finished collecting timing info
21:56:02.236189 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 1.82s]
21:56:02.237144 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:56:02.609000 [debug] [Thread-2  ]: finished collecting timing info
21:56:02.610134 [info ] [Thread-2  ]: 2 of 2 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 2.19s]
21:56:02.610700 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:56:02.613152 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:56:02.613793 [info ] [MainThread]: 
21:56:02.614201 [info ] [MainThread]: Finished running 2 tests in 2.83s.
21:56:02.614561 [debug] [MainThread]: Connection 'master' was properly closed.
21:56:02.614754 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
21:56:02.614920 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
21:56:02.622938 [info ] [MainThread]: 
21:56:02.623346 [info ] [MainThread]: [32mCompleted successfully[0m
21:56:02.623670 [info ] [MainThread]: 
21:56:02.623934 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
21:56:02.624369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee56fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efd6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef59940>]}


============================== 2022-05-19 21:57:54.982904 | 9945162d-2f1b-4d99-8618-bf7eed6db555 ==============================
21:57:54.982904 [info ] [MainThread]: Running with dbt=1.0.4
21:57:54.984134 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
21:57:54.984300 [debug] [MainThread]: Tracking: tracking
21:57:55.011574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d8fa0>]}
21:57:55.030932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e914e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e91c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e91c610>]}


============================== 2022-05-19 21:58:39.253632 | 57b7dfb5-b747-4f84-9daf-059d44f97dd6 ==============================
21:58:39.253632 [info ] [MainThread]: Running with dbt=1.0.4
21:58:39.254542 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
21:58:39.255022 [debug] [MainThread]: Tracking: tracking
21:58:39.277111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fe880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fefa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fe970>]}
21:58:39.296476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2309a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f230820>]}


============================== 2022-05-19 21:59:22.290188 | 7fba2374-664e-456b-bc3b-9ed5ef5de056 ==============================
21:59:22.290188 [info ] [MainThread]: Running with dbt=1.0.4
21:59:22.291017 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
21:59:22.291495 [debug] [MainThread]: Tracking: tracking
21:59:22.314149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120e040>]}
21:59:22.344165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:59:22.344703 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
21:59:22.354927 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
21:59:22.391148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fba2374-664e-456b-bc3b-9ed5ef5de056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114080d0>]}
21:59:22.395713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fba2374-664e-456b-bc3b-9ed5ef5de056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111340940>]}
21:59:22.395912 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
21:59:22.396993 [info ] [MainThread]: 
21:59:22.397320 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:59:22.398122 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
21:59:22.398308 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:59:23.010028 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
21:59:23.010803 [info ] [MainThread]: 
21:59:23.020413 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd
21:59:23.020683 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:59:23.020876 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:59:23.021176 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_stg_orders_status__shipped__completed__return_pending [RUN]
21:59:23.022513 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_orders_order_id.................................. [RUN]
21:59:23.022905 [info ] [Thread-3  ]: 3 of 3 START test unique_stg_orders_order_id.................................... [RUN]
21:59:23.023826 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd"
21:59:23.024321 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
21:59:23.024751 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
21:59:23.024949 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd
21:59:23.025248 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:59:23.025530 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:59:23.025767 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd
21:59:23.025943 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:59:23.026089 [debug] [Thread-3  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:59:23.032695 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd"
21:59:23.038473 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
21:59:23.043923 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
21:59:23.044625 [debug] [Thread-1  ]: finished collecting timing info
21:59:23.044743 [debug] [Thread-2  ]: finished collecting timing info
21:59:23.044903 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd
21:59:23.045080 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:59:23.045172 [debug] [Thread-3  ]: finished collecting timing info
21:59:23.062295 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd"
21:59:23.063652 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
21:59:23.063799 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:59:23.065189 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
21:59:23.065432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:59:23.065603 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:59:23.065735 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:59:23.066722 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending'
)



      
    ) dbt_internal_test
21:59:23.067656 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
21:59:23.099433 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
21:59:24.669275 [debug] [Thread-2  ]: finished collecting timing info
21:59:24.669873 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 1.65s]
21:59:24.670525 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
21:59:24.819231 [debug] [Thread-3  ]: finished collecting timing info
21:59:24.819606 [info ] [Thread-3  ]: 3 of 3 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 1.79s]
21:59:24.819827 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
21:59:25.058433 [debug] [Thread-1  ]: finished collecting timing info
21:59:25.059323 [error] [Thread-1  ]: 1 of 3 FAIL 2 accepted_values_stg_orders_status__shipped__completed__return_pending [[31mFAIL 2[0m in 2.04s]
21:59:25.059833 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd
21:59:25.061762 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:59:25.062296 [info ] [MainThread]: 
21:59:25.062614 [info ] [MainThread]: Finished running 3 tests in 2.67s.
21:59:25.062907 [debug] [MainThread]: Connection 'master' was properly closed.
21:59:25.063067 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending.0d39461dbd' was properly closed.
21:59:25.063208 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
21:59:25.063343 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
21:59:25.071161 [info ] [MainThread]: 
21:59:25.071520 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
21:59:25.071830 [info ] [MainThread]: 
21:59:25.072076 [error] [MainThread]: [31mFailure in test accepted_values_stg_orders_status__shipped__completed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)[0m
21:59:25.072330 [error] [MainThread]:   Got 2 results, configured to fail if != 0
21:59:25.072543 [info ] [MainThread]: 
21:59:25.072762 [info ] [MainThread]:   compiled SQL at target/compiled/jaffle_shop/models/staging/jaffle_shop/stg_jaffle_shop.yml/accepted_values_stg_orders_301fcd8f8f16fb4ac59c2edeb60029d9.sql
21:59:25.072990 [info ] [MainThread]: 
21:59:25.073204 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
21:59:25.073580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111560f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112bbbe0>]}


============================== 2022-05-19 22:03:03.072229 | b615f255-24dc-4ae0-be3e-f637b5e21d87 ==============================
22:03:03.072229 [info ] [MainThread]: Running with dbt=1.0.4
22:03:03.073246 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['target/compiled/jaffle_shop/models/staging/jaffle_shop/stg_jaffle_shop.yml/accepted_values_stg_orders_301fcd8f8f16fb4ac59c2edeb60029d9.sql'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:03:03.073464 [debug] [MainThread]: Tracking: tracking
22:03:03.099611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113e6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113be610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113be250>]}
22:03:03.131362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:03:03.131564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:03:03.135892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b615f255-24dc-4ae0-be3e-f637b5e21d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11154c0d0>]}
22:03:03.140902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b615f255-24dc-4ae0-be3e-f637b5e21d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113d5ca0>]}
22:03:03.141097 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:03:03.141886 [warn ] [MainThread]: The selection criterion 'target/compiled/jaffle_shop/models/staging/jaffle_shop/stg_jaffle_shop.yml/accepted_values_stg_orders_301fcd8f8f16fb4ac59c2edeb60029d9.sql' does not match any nodes
22:03:03.142617 [info ] [MainThread]: 
22:03:03.142782 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
22:03:03.146770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111493370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111493100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114931c0>]}


============================== 2022-05-19 22:04:46.035769 | 4aa45473-456d-4404-ad1f-c14917fa2353 ==============================
22:04:46.035769 [info ] [MainThread]: Running with dbt=1.0.4
22:04:46.036881 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_jaffle_shop'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:04:46.037120 [debug] [MainThread]: Tracking: tracking
22:04:46.063437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8f99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8f9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8f9520>]}
22:04:46.092583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:04:46.093070 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
22:04:46.101531 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
22:04:46.136677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4aa45473-456d-4404-ad1f-c14917fa2353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eadbfa0>]}
22:04:46.140983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4aa45473-456d-4404-ad1f-c14917fa2353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9408b0>]}
22:04:46.141166 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:04:46.141625 [warn ] [MainThread]: The selection criterion 'stg_jaffle_shop' does not match any nodes
22:04:46.142283 [info ] [MainThread]: 
22:04:46.142464 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
22:04:46.145568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccf7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e940af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e940070>]}


============================== 2022-05-19 22:05:40.130761 | daeaeafb-9aa1-444e-827e-8ad0bc792853 ==============================
22:05:40.130761 [info ] [MainThread]: Running with dbt=1.0.4
22:05:40.131832 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_jaffle_shop'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:05:40.132054 [debug] [MainThread]: Tracking: tracking
22:05:40.154106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc3b50>]}
22:05:40.184990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:05:40.185221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:05:40.189571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daeaeafb-9aa1-444e-827e-8ad0bc792853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f1df70>]}
22:05:40.194423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daeaeafb-9aa1-444e-827e-8ad0bc792853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e4d220>]}
22:05:40.194620 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:05:40.195164 [warn ] [MainThread]: The selection criterion 'stg_jaffle_shop' does not match any nodes
22:05:40.195841 [info ] [MainThread]: 
22:05:40.196023 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
22:05:40.199722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e4d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e4d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e4d070>]}


============================== 2022-05-19 22:06:18.297401 | ea35c390-958d-443a-9f71-54ccbc06a8cc ==============================
22:06:18.297401 [info ] [MainThread]: Running with dbt=1.0.4
22:06:18.298298 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:06:18.298545 [debug] [MainThread]: Tracking: tracking
22:06:18.318842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e701190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e701820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e701400>]}
22:06:18.349648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:06:18.349837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:06:18.354194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea35c390-958d-443a-9f71-54ccbc06a8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8680d0>]}
22:06:18.359339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea35c390-958d-443a-9f71-54ccbc06a8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d2a60>]}
22:06:18.359530 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:06:18.360665 [info ] [MainThread]: 
22:06:18.360985 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:06:18.361777 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:06:18.361944 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:06:19.097826 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:06:19.098736 [info ] [MainThread]: 
22:06:19.106431 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:06:19.106681 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:06:19.106907 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:06:19.107224 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [RUN]
22:06:19.107513 [info ] [Thread-2  ]: 2 of 3 START test not_null_stg_orders_order_id.................................. [RUN]
22:06:19.107758 [info ] [Thread-3  ]: 3 of 3 START test unique_stg_orders_order_id.................................... [RUN]
22:06:19.108357 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:06:19.108948 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:06:19.109542 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:06:19.109702 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:06:19.109885 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:06:19.110061 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:06:19.110293 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:06:19.110466 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:06:19.110623 [debug] [Thread-3  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:06:19.127453 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:06:19.132834 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:06:19.137813 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:06:19.138561 [debug] [Thread-1  ]: finished collecting timing info
22:06:19.138736 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:06:19.145137 [debug] [Thread-2  ]: finished collecting timing info
22:06:19.145268 [debug] [Thread-3  ]: finished collecting timing info
22:06:19.155427 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:06:19.155641 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:06:19.155752 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:06:19.157086 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:06:19.158280 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:06:19.158418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:06:19.159783 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned','placed'
)



      
    ) dbt_internal_test
22:06:19.159950 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:06:19.160059 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:06:19.191926 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:06:19.192772 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
22:06:20.729916 [debug] [Thread-2  ]: finished collecting timing info
22:06:20.731281 [info ] [Thread-2  ]: 2 of 3 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 1.62s]
22:06:20.733336 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:06:20.892567 [debug] [Thread-3  ]: finished collecting timing info
22:06:20.893067 [info ] [Thread-3  ]: 3 of 3 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 1.78s]
22:06:20.893280 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:06:21.523299 [debug] [Thread-1  ]: finished collecting timing info
22:06:21.524517 [info ] [Thread-1  ]: 1 of 3 PASS accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [[32mPASS[0m in 2.42s]
22:06:21.525124 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:06:21.527620 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:06:21.528242 [info ] [MainThread]: 
22:06:21.528627 [info ] [MainThread]: Finished running 3 tests in 3.17s.
22:06:21.528983 [debug] [MainThread]: Connection 'master' was properly closed.
22:06:21.529161 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7' was properly closed.
22:06:21.529326 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
22:06:21.529491 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
22:06:21.547440 [info ] [MainThread]: 
22:06:21.554288 [info ] [MainThread]: [32mCompleted successfully[0m
22:06:21.554598 [info ] [MainThread]: 
22:06:21.554810 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
22:06:21.555209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e850190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d2970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e84ddf0>]}


============================== 2022-05-19 22:11:30.496029 | f898afff-2c4a-413d-a7bc-bba05cbe7dac ==============================
22:11:30.496029 [info ] [MainThread]: Running with dbt=1.0.4
22:11:30.497846 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:11:30.498579 [debug] [MainThread]: Tracking: tracking
22:11:30.522941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b0670>]}
22:11:30.552391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:11:30.552926 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
22:11:30.563585 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
22:11:30.605209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f898afff-2c4a-413d-a7bc-bba05cbe7dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135930d0>]}
22:11:30.610262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f898afff-2c4a-413d-a7bc-bba05cbe7dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113401dc0>]}
22:11:30.610457 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:11:30.611642 [info ] [MainThread]: 
22:11:30.611975 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:11:30.612728 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:11:30.612895 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:11:31.303683 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:11:31.304579 [info ] [MainThread]: 
22:11:31.314966 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:11:31.315236 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:11:31.315645 [debug] [Thread-3  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:11:31.315966 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:11:31.316334 [info ] [Thread-1  ]: 1 of 4 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [RUN]
22:11:31.316605 [info ] [Thread-2  ]: 2 of 4 START test not_null_stg_orders_order_id.................................. [RUN]
22:11:31.316802 [info ] [Thread-3  ]: 3 of 4 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
22:11:31.316984 [info ] [Thread-4  ]: 4 of 4 START test unique_stg_orders_order_id.................................... [RUN]
22:11:31.317622 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:11:31.318109 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:11:31.318575 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:11:31.319444 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:11:31.319698 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:11:31.319886 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:11:31.320176 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:11:31.320412 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:11:31.320652 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:11:31.320818 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:11:31.320957 [debug] [Thread-3  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:11:31.321097 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:11:31.328707 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:11:31.334438 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:11:31.338653 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:11:31.343653 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:11:31.344549 [debug] [Thread-3  ]: finished collecting timing info
22:11:31.344704 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:11:31.351150 [debug] [Thread-1  ]: finished collecting timing info
22:11:31.361540 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:11:31.361681 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:11:31.361799 [debug] [Thread-2  ]: finished collecting timing info
22:11:31.361912 [debug] [Thread-4  ]: finished collecting timing info
22:11:31.363248 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:11:31.363378 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:11:31.363529 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:11:31.363616 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:11:31.364865 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:11:31.365077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:11:31.366220 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:11:31.367175 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:11:31.368123 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned','placed'
)



      
    ) dbt_internal_test
22:11:31.368228 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:11:31.428681 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
22:11:31.428897 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:11:31.459327 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:11:32.876226 [debug] [Thread-2  ]: finished collecting timing info
22:11:32.876720 [info ] [Thread-2  ]: 2 of 4 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 1.56s]
22:11:32.877437 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:11:32.940685 [debug] [Thread-1  ]: finished collecting timing info
22:11:32.941192 [info ] [Thread-1  ]: 1 of 4 PASS accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [[32mPASS[0m in 1.62s]
22:11:32.941453 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:11:32.986240 [debug] [Thread-4  ]: finished collecting timing info
22:11:32.986705 [info ] [Thread-4  ]: 4 of 4 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 1.67s]
22:11:32.986961 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:11:33.381434 [debug] [Thread-3  ]: finished collecting timing info
22:11:33.382355 [info ] [Thread-3  ]: 3 of 4 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [[32mPASS[0m in 2.06s]
22:11:33.382715 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:11:33.385011 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:11:33.385657 [info ] [MainThread]: 
22:11:33.385960 [info ] [MainThread]: Finished running 4 tests in 2.77s.
22:11:33.386211 [debug] [MainThread]: Connection 'master' was properly closed.
22:11:33.386343 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7' was properly closed.
22:11:33.386458 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
22:11:33.386570 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
22:11:33.386680 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
22:11:33.392961 [info ] [MainThread]: 
22:11:33.393225 [info ] [MainThread]: [32mCompleted successfully[0m
22:11:33.393454 [info ] [MainThread]: 
22:11:33.393643 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
22:11:33.393920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11356be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11356b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113401a00>]}


============================== 2022-05-19 22:22:07.940321 | 59e4b76d-f724-4db9-ac71-9856e07a79ab ==============================
22:22:07.940321 [info ] [MainThread]: Running with dbt=1.0.4
22:22:07.941634 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:22:07.941889 [debug] [MainThread]: Tracking: tracking
22:22:07.963689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1f4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1f4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1f4220>]}
22:22:07.994052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:22:07.994257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:22:07.998632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59e4b76d-f724-4db9-ac71-9856e07a79ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35ea90>]}
22:22:08.004062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59e4b76d-f724-4db9-ac71-9856e07a79ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1f5370>]}
22:22:08.004256 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:22:08.005421 [info ] [MainThread]: 
22:22:08.005743 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:22:08.006565 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:22:08.006739 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:22:08.774389 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:22:08.775125 [info ] [MainThread]: 
22:22:08.783144 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:22:08.783388 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:22:08.783624 [debug] [Thread-3  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:22:08.783819 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:22:08.784120 [info ] [Thread-1  ]: 1 of 4 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [RUN]
22:22:08.784369 [info ] [Thread-2  ]: 2 of 4 START test not_null_stg_orders_order_id.................................. [RUN]
22:22:08.784598 [info ] [Thread-3  ]: 3 of 4 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
22:22:08.784795 [info ] [Thread-4  ]: 4 of 4 START test unique_stg_orders_order_id.................................... [RUN]
22:22:08.785438 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:22:08.785866 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:22:08.786296 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:22:08.786655 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:22:08.786862 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:22:08.787017 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:22:08.787169 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:22:08.787320 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:22:08.787521 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:22:08.787664 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:22:08.787798 [debug] [Thread-3  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:22:08.788090 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:22:08.802035 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:22:08.807034 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:22:08.813037 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:22:08.817334 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:22:08.818141 [debug] [Thread-3  ]: finished collecting timing info
22:22:08.818295 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:22:08.833326 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:22:08.833510 [debug] [Thread-4  ]: finished collecting timing info
22:22:08.833593 [debug] [Thread-1  ]: finished collecting timing info
22:22:08.833668 [debug] [Thread-2  ]: finished collecting timing info
22:22:08.833790 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:22:08.833902 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:22:08.833999 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:22:08.835098 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:22:08.835221 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:22:08.836244 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:22:08.837256 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:22:08.838331 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:22:08.838526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:22:08.839221 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:22:08.839319 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:22:08.869805 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned','placed'
)



      
    ) dbt_internal_test
22:22:08.870652 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
22:22:08.871315 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:22:10.556695 [debug] [Thread-1  ]: finished collecting timing info
22:22:10.557593 [info ] [Thread-1  ]: 1 of 4 PASS accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [[32mPASS[0m in 1.77s]
22:22:10.559470 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:22:10.575640 [debug] [Thread-2  ]: finished collecting timing info
22:22:10.576415 [info ] [Thread-2  ]: 2 of 4 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 1.79s]
22:22:10.576801 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:22:10.583426 [debug] [Thread-3  ]: finished collecting timing info
22:22:10.584441 [info ] [Thread-3  ]: 3 of 4 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [[32mPASS[0m in 1.80s]
22:22:10.584913 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:22:10.589750 [debug] [Thread-4  ]: finished collecting timing info
22:22:10.590357 [info ] [Thread-4  ]: 4 of 4 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 1.80s]
22:22:10.590669 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:22:10.592322 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:22:10.592758 [info ] [MainThread]: 
22:22:10.593018 [info ] [MainThread]: Finished running 4 tests in 2.59s.
22:22:10.593253 [debug] [MainThread]: Connection 'master' was properly closed.
22:22:10.593382 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7' was properly closed.
22:22:10.593495 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
22:22:10.593604 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
22:22:10.593710 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
22:22:10.600664 [info ] [MainThread]: 
22:22:10.601004 [info ] [MainThread]: [32mCompleted successfully[0m
22:22:10.601246 [info ] [MainThread]: 
22:22:10.601654 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
22:22:10.602075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f208f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f208460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b1730>]}


============================== 2022-05-19 22:31:39.088781 | 304c3892-49de-4ab2-a9c9-b55fad0d2250 ==============================
22:31:39.088781 [info ] [MainThread]: Running with dbt=1.0.4
22:31:39.089710 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_payments'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:31:39.090157 [debug] [MainThread]: Tracking: tracking
22:31:39.111142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111505490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111505430>]}
22:31:39.141925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
22:31:39.142289 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://tests/assert_stg_payments_total_value_positive.sql
22:31:39.166599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '304c3892-49de-4ab2-a9c9-b55fad0d2250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c50d0>]}
22:31:39.171924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '304c3892-49de-4ab2-a9c9-b55fad0d2250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d4940>]}
22:31:39.172113 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:31:39.173417 [info ] [MainThread]: 
22:31:39.173838 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:31:39.174630 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:31:39.174840 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:31:39.905614 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:31:39.906457 [info ] [MainThread]: 
22:31:39.914060 [debug] [Thread-1  ]: Began running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:31:39.914709 [info ] [Thread-1  ]: 1 of 1 START test assert_stg_payments_total_value_positive...................... [RUN]
22:31:39.915929 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:31:39.916208 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.assert_stg_payments_total_value_positive
22:31:39.916474 [debug] [Thread-1  ]: Compiling test.jaffle_shop.assert_stg_payments_total_value_positive
22:31:39.920072 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:31:39.921032 [debug] [Thread-1  ]: finished collecting timing info
22:31:39.921243 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.assert_stg_payments_total_value_positive
22:31:39.943980 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:31:39.944622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:31:39.945886 [debug] [Thread-1  ]: On test.jaffle_shop.assert_stg_payments_total_value_positive: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.assert_stg_payments_total_value_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with

payments as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
)

select
    order_id
    sum(amount) as total_amount
from payments
group by order_id
having total_amount < 0
      
    ) dbt_internal_test
22:31:40.654232 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "(" at [15:8]')
22:31:41.866351 [debug] [Thread-1  ]: finished collecting timing info
22:31:41.867109 [debug] [Thread-1  ]: Database Error in test assert_stg_payments_total_value_positive (tests/assert_stg_payments_total_value_positive.sql)
  Syntax error: Expected ")" but got "(" at [15:8]
  compiled SQL at target/run/jaffle_shop/tests/assert_stg_payments_total_value_positive.sql
22:31:41.867402 [error] [Thread-1  ]: 1 of 1 ERROR assert_stg_payments_total_value_positive........................... [[31mERROR[0m in 1.95s]
22:31:41.867697 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:31:41.869706 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:31:41.870517 [info ] [MainThread]: 
22:31:41.870983 [info ] [MainThread]: Finished running 1 test in 2.70s.
22:31:41.871409 [debug] [MainThread]: Connection 'master' was properly closed.
22:31:41.871636 [debug] [MainThread]: Connection 'test.jaffle_shop.assert_stg_payments_total_value_positive' was properly closed.
22:31:41.882662 [info ] [MainThread]: 
22:31:41.883174 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
22:31:41.883443 [info ] [MainThread]: 
22:31:41.883655 [error] [MainThread]: [33mDatabase Error in test assert_stg_payments_total_value_positive (tests/assert_stg_payments_total_value_positive.sql)[0m
22:31:41.884179 [error] [MainThread]:   Syntax error: Expected ")" but got "(" at [15:8]
22:31:41.884424 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/tests/assert_stg_payments_total_value_positive.sql
22:31:41.884658 [info ] [MainThread]: 
22:31:41.884912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
22:31:41.885263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117c3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117c36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111783460>]}


============================== 2022-05-19 22:33:49.545065 | 412d0803-94fa-4dab-899a-6d8a7f0dc00f ==============================
22:33:49.545065 [info ] [MainThread]: Running with dbt=1.0.4
22:33:49.546174 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_payments'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:33:49.546716 [debug] [MainThread]: Tracking: tracking
22:33:49.566873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed23be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed23340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed23430>]}
22:33:49.598763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:33:49.599133 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://tests/assert_stg_payments_total_value_positive.sql
22:33:49.622025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '412d0803-94fa-4dab-899a-6d8a7f0dc00f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eef00d0>]}
22:33:49.626874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '412d0803-94fa-4dab-899a-6d8a7f0dc00f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee00d90>]}
22:33:49.627072 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:33:49.628146 [info ] [MainThread]: 
22:33:49.628470 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:33:49.629276 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:33:49.629507 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:33:50.357651 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:33:50.358570 [info ] [MainThread]: 
22:33:50.367839 [debug] [Thread-1  ]: Began running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:33:50.368270 [info ] [Thread-1  ]: 1 of 1 START test assert_stg_payments_total_value_positive...................... [RUN]
22:33:50.369093 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:33:50.369333 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.assert_stg_payments_total_value_positive
22:33:50.369569 [debug] [Thread-1  ]: Compiling test.jaffle_shop.assert_stg_payments_total_value_positive
22:33:50.373235 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:33:50.374307 [debug] [Thread-1  ]: finished collecting timing info
22:33:50.374527 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.assert_stg_payments_total_value_positive
22:33:50.396778 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:33:50.397381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:33:50.398602 [debug] [Thread-1  ]: On test.jaffle_shop.assert_stg_payments_total_value_positive: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.assert_stg_payments_total_value_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with

payments as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
)

select
    order_id,
    sum(amount) as total_amount
from payments
group by order_id
having total_amount < 0
      
    ) dbt_internal_test
22:33:52.667477 [debug] [Thread-1  ]: finished collecting timing info
22:33:52.668463 [info ] [Thread-1  ]: 1 of 1 PASS assert_stg_payments_total_value_positive............................ [[32mPASS[0m in 2.30s]
22:33:52.670437 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:33:52.672097 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:33:52.672559 [info ] [MainThread]: 
22:33:52.672859 [info ] [MainThread]: Finished running 1 test in 3.04s.
22:33:52.673117 [debug] [MainThread]: Connection 'master' was properly closed.
22:33:52.673262 [debug] [MainThread]: Connection 'test.jaffle_shop.assert_stg_payments_total_value_positive' was properly closed.
22:33:52.682058 [info ] [MainThread]: 
22:33:52.682343 [info ] [MainThread]: [32mCompleted successfully[0m
22:33:52.682560 [info ] [MainThread]: 
22:33:52.682746 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:33:52.683012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f00eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f00ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f00e760>]}


============================== 2022-05-19 22:41:19.188451 | aabacd16-342d-4a19-815c-3093eed02b6a ==============================
22:41:19.188451 [info ] [MainThread]: Running with dbt=1.0.4
22:41:19.189321 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['jaffle_shop'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:41:19.189840 [debug] [MainThread]: Tracking: tracking
22:41:19.212858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11332b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11332b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11332b1c0>]}
22:41:19.244079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:41:19.244649 [debug] [MainThread]: Partial parsing: deleted source source.jaffle_shop.jaffle_shop.customers
22:41:19.244849 [debug] [MainThread]: Partial parsing: deleted source source.jaffle_shop.jaffle_shop.orders
22:41:19.244948 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
22:41:19.253985 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
22:41:19.261863 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
22:41:19.263263 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
22:41:19.266671 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
22:41:19.267327 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
22:41:19.319484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aabacd16-342d-4a19-815c-3093eed02b6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134de0a0>]}
22:41:19.328004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aabacd16-342d-4a19-815c-3093eed02b6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11332b130>]}
22:41:19.328241 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:41:19.329748 [info ] [MainThread]: 
22:41:19.330083 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:41:19.330909 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:41:19.331080 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:41:20.415130 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:41:20.415957 [info ] [MainThread]: 
22:41:20.424499 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:41:20.424793 [debug] [Thread-2  ]: Began running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:41:20.425012 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:41:20.425194 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:41:20.425392 [debug] [Thread-5  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:41:20.425563 [debug] [Thread-6  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:41:20.425841 [info ] [Thread-1  ]: 1 of 11 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [RUN]
22:41:20.426287 [info ] [Thread-2  ]: 2 of 11 START test assert_stg_payments_total_value_positive..................... [RUN]
22:41:20.426545 [info ] [Thread-3  ]: 3 of 11 START test not_null_stg_customers_customer_id........................... [RUN]
22:41:20.426769 [info ] [Thread-4  ]: 4 of 11 START test not_null_stg_orders_order_id................................. [RUN]
22:41:20.427004 [info ] [Thread-5  ]: 5 of 11 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
22:41:20.427190 [info ] [Thread-6  ]: 6 of 11 START test source_not_null_jaffle_shop_customers_id..................... [RUN]
22:41:20.427859 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:41:20.428670 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:41:20.429420 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:41:20.430264 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:41:20.430959 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:41:20.431699 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:41:20.431962 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:41:20.432138 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.assert_stg_payments_total_value_positive
22:41:20.432299 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:41:20.432451 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:41:20.432600 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:41:20.432740 [debug] [Thread-6  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:41:20.432942 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:41:20.433090 [debug] [Thread-2  ]: Compiling test.jaffle_shop.assert_stg_payments_total_value_positive
22:41:20.433235 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:41:20.433372 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:41:20.433505 [debug] [Thread-5  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:41:20.433636 [debug] [Thread-6  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:41:20.440883 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:41:20.446715 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:41:20.450520 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:41:20.453564 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:41:20.457433 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:41:20.460310 [debug] [Thread-6  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:41:20.460979 [debug] [Thread-3  ]: finished collecting timing info
22:41:20.461228 [debug] [Thread-2  ]: finished collecting timing info
22:41:20.461685 [debug] [Thread-1  ]: finished collecting timing info
22:41:20.461799 [debug] [Thread-4  ]: finished collecting timing info
22:41:20.461943 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:41:20.462119 [debug] [Thread-5  ]: finished collecting timing info
22:41:20.462281 [debug] [Thread-6  ]: finished collecting timing info
22:41:20.462389 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.assert_stg_payments_total_value_positive
22:41:20.462524 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:41:20.462669 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:41:20.478472 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:41:20.478665 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:41:20.478819 [debug] [Thread-6  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:41:20.480125 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:41:20.481250 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:41:20.482466 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:41:20.483783 [debug] [Thread-5  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:41:20.485014 [debug] [Thread-6  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:41:20.485151 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:41:20.486702 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
22:41:20.487622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:41:20.487737 [debug] [Thread-5  ]: Opening a new connection, currently in state init
22:41:20.487829 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:41:20.517585 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:41:20.517937 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:41:20.518786 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned','placed'
)



      
    ) dbt_internal_test
22:41:20.519795 [debug] [Thread-5  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:41:20.520675 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
22:41:20.521477 [debug] [Thread-6  ]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
where id is null



      
    ) dbt_internal_test
22:41:20.551166 [debug] [Thread-2  ]: On test.jaffle_shop.assert_stg_payments_total_value_positive: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.assert_stg_payments_total_value_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with

payments as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
)

select
    order_id,
    sum(amount) as total_amount
from payments
group by order_id
having total_amount < 0
      
    ) dbt_internal_test
22:41:22.212290 [debug] [Thread-3  ]: finished collecting timing info
22:41:22.213374 [info ] [Thread-3  ]: 3 of 11 PASS not_null_stg_customers_customer_id................................. [[32mPASS[0m in 1.78s]
22:41:22.216316 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:41:22.218419 [debug] [Thread-1  ]: finished collecting timing info
22:41:22.218755 [debug] [Thread-3  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:41:22.219336 [info ] [Thread-1  ]: 1 of 11 PASS accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [[32mPASS[0m in 1.79s]
22:41:22.221898 [debug] [Thread-2  ]: finished collecting timing info
22:41:22.222164 [info ] [Thread-3  ]: 7 of 11 START test source_not_null_jaffle_shop_orders_id........................ [RUN]
22:41:22.222527 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:41:22.222932 [info ] [Thread-2  ]: 2 of 11 PASS assert_stg_payments_total_value_positive........................... [[32mPASS[0m in 1.79s]
22:41:22.223446 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:41:22.223691 [debug] [Thread-1  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:41:22.223993 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:41:22.224269 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:41:22.224474 [info ] [Thread-1  ]: 8 of 11 START test source_unique_jaffle_shop_customers_id....................... [RUN]
22:41:22.224701 [debug] [Thread-2  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:41:22.225058 [debug] [Thread-3  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:41:22.225558 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:41:22.225740 [info ] [Thread-2  ]: 9 of 11 START test source_unique_jaffle_shop_orders_id.......................... [RUN]
22:41:22.230507 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:41:22.230764 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:41:22.231175 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:41:22.231446 [debug] [Thread-1  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:41:22.231634 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:41:22.238133 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:41:22.238341 [debug] [Thread-3  ]: finished collecting timing info
22:41:22.238524 [debug] [Thread-2  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:41:22.238771 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:41:22.241886 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:41:22.241999 [debug] [Thread-1  ]: finished collecting timing info
22:41:22.244031 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:41:22.245264 [debug] [Thread-5  ]: finished collecting timing info
22:41:22.245494 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:41:22.245872 [info ] [Thread-5  ]: 5 of 11 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [[32mPASS[0m in 1.82s]
22:41:22.245986 [debug] [Thread-2  ]: finished collecting timing info
22:41:22.247377 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:41:22.247555 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
22:41:22.247774 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:41:22.247894 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:41:22.248287 [debug] [Thread-5  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:41:22.248534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:41:22.249835 [debug] [Thread-3  ]: On test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
where id is null



      
    ) dbt_internal_test
22:41:22.251425 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:41:22.253122 [debug] [Thread-4  ]: finished collecting timing info
22:41:22.253295 [info ] [Thread-5  ]: 10 of 11 START test unique_stg_customers_customer_id............................ [RUN]
22:41:22.254536 [debug] [Thread-1  ]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:41:22.289635 [info ] [Thread-4  ]: 4 of 11 PASS not_null_stg_orders_order_id....................................... [[32mPASS[0m in 1.86s]
22:41:22.289787 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:41:22.290061 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:41:22.319850 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:41:22.320816 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:41:22.321697 [debug] [Thread-2  ]: On test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:41:22.321932 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:41:22.322403 [debug] [Thread-5  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:41:22.353725 [info ] [Thread-4  ]: 11 of 11 START test unique_stg_orders_order_id.................................. [RUN]
22:41:22.356803 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:41:22.357589 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:41:22.357759 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:41:22.357857 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:41:22.360254 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:41:22.360599 [debug] [Thread-5  ]: finished collecting timing info
22:41:22.360859 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:41:22.362106 [debug] [Thread-5  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:41:22.362839 [debug] [Thread-4  ]: finished collecting timing info
22:41:22.362986 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
22:41:22.363075 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:41:22.364043 [debug] [Thread-5  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:41:22.365288 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:41:22.396517 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
22:41:22.397559 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:41:22.675660 [debug] [Thread-6  ]: finished collecting timing info
22:41:22.676642 [info ] [Thread-6  ]: 6 of 11 PASS source_not_null_jaffle_shop_customers_id........................... [[32mPASS[0m in 2.25s]
22:41:22.677123 [debug] [Thread-6  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:41:23.896428 [debug] [Thread-4  ]: finished collecting timing info
22:41:23.897520 [info ] [Thread-4  ]: 11 of 11 PASS unique_stg_orders_order_id........................................ [[32mPASS[0m in 1.54s]
22:41:23.898099 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:41:23.992396 [debug] [Thread-5  ]: finished collecting timing info
22:41:23.994406 [info ] [Thread-5  ]: 10 of 11 PASS unique_stg_customers_customer_id.................................. [[32mPASS[0m in 1.70s]
22:41:23.995068 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:41:24.220342 [debug] [Thread-3  ]: finished collecting timing info
22:41:24.221505 [info ] [Thread-3  ]: 7 of 11 PASS source_not_null_jaffle_shop_orders_id.............................. [[32mPASS[0m in 2.00s]
22:41:24.221932 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:41:24.472922 [debug] [Thread-1  ]: finished collecting timing info
22:41:24.474059 [info ] [Thread-1  ]: 8 of 11 PASS source_unique_jaffle_shop_customers_id............................. [[32mPASS[0m in 2.25s]
22:41:24.474607 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:45:12.395741 [debug] [Thread-2  ]: finished collecting timing info
22:45:12.398446 [info ] [Thread-2  ]: 9 of 11 PASS source_unique_jaffle_shop_orders_id................................ [[32mPASS[0m in 230.17s]
22:45:12.398800 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:45:12.401042 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:45:12.401570 [info ] [MainThread]: 
22:45:12.401776 [info ] [MainThread]: Finished running 11 tests in 233.07s.
22:45:12.401964 [debug] [MainThread]: Connection 'master' was properly closed.
22:45:12.402055 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e' was properly closed.
22:45:12.402137 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba' was properly closed.
22:45:12.402211 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13' was properly closed.
22:45:12.402286 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
22:45:12.402447 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
22:45:12.402536 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f' was properly closed.
22:45:12.414172 [info ] [MainThread]: 
22:45:12.414429 [info ] [MainThread]: [32mCompleted successfully[0m
22:45:12.414614 [info ] [MainThread]: 
22:45:12.414760 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
22:45:12.415053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136421c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134837f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11356aa30>]}


============================== 2022-05-19 22:45:15.050498 | df8e934d-c0f9-45d8-bcad-4ad86270eb9d ==============================
22:45:15.050498 [info ] [MainThread]: Running with dbt=1.0.4
22:45:15.052656 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:45:15.053369 [debug] [MainThread]: Tracking: tracking
22:45:15.076941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a41700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a41a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a41190>]}
22:45:15.106304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:45:15.106500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:45:15.110581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df8e934d-c0f9-45d8-bcad-4ad86270eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bbd0d0>]}
22:45:15.115846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df8e934d-c0f9-45d8-bcad-4ad86270eb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b17a60>]}
22:45:15.116037 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:45:15.117501 [info ] [MainThread]: 
22:45:15.117822 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:45:15.118617 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:45:15.118773 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:45:15.842462 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:45:15.843059 [info ] [MainThread]: 
22:45:15.849577 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:45:15.849825 [debug] [Thread-2  ]: Began running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:45:15.850049 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:45:15.850152 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:45:15.850362 [debug] [Thread-5  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:45:15.850630 [debug] [Thread-6  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:45:15.850858 [info ] [Thread-1  ]: 1 of 11 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [RUN]
22:45:15.851108 [info ] [Thread-2  ]: 2 of 11 START test assert_stg_payments_total_value_positive..................... [RUN]
22:45:15.851353 [info ] [Thread-3  ]: 3 of 11 START test not_null_stg_customers_customer_id........................... [RUN]
22:45:15.851571 [info ] [Thread-4  ]: 4 of 11 START test not_null_stg_orders_order_id................................. [RUN]
22:45:15.851716 [info ] [Thread-5  ]: 5 of 11 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
22:45:15.851840 [info ] [Thread-6  ]: 6 of 11 START test source_not_null_jaffle_shop_customers_id..................... [RUN]
22:45:15.852561 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:45:15.853056 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:45:15.853424 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:45:15.853918 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:45:15.854379 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:45:15.854985 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:45:15.855153 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:45:15.855281 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.assert_stg_payments_total_value_positive
22:45:15.855398 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:45:15.855513 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:45:15.855627 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:45:15.855739 [debug] [Thread-6  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:45:15.855895 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:45:15.856016 [debug] [Thread-2  ]: Compiling test.jaffle_shop.assert_stg_payments_total_value_positive
22:45:15.856128 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:45:15.856238 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:45:15.856354 [debug] [Thread-5  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:45:15.856463 [debug] [Thread-6  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:45:15.872763 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:45:15.875003 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:45:15.880484 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:45:15.883612 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:45:15.889934 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:45:15.892583 [debug] [Thread-6  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:45:15.893370 [debug] [Thread-2  ]: finished collecting timing info
22:45:15.893927 [debug] [Thread-4  ]: finished collecting timing info
22:45:15.894166 [debug] [Thread-3  ]: finished collecting timing info
22:45:15.894271 [debug] [Thread-1  ]: finished collecting timing info
22:45:15.894387 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.assert_stg_payments_total_value_positive
22:45:15.894512 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:45:15.894619 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:45:15.894775 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:45:15.894896 [debug] [Thread-6  ]: finished collecting timing info
22:45:15.894988 [debug] [Thread-5  ]: finished collecting timing info
22:45:15.910491 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:45:15.912769 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:45:15.913870 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:45:15.914923 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:45:15.915065 [debug] [Thread-6  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:45:15.915171 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:45:15.915685 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:45:15.915912 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:45:15.917118 [debug] [Thread-6  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:45:15.918317 [debug] [Thread-5  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:45:15.918418 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:45:15.918658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:45:15.919129 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:45:15.920047 [debug] [Thread-2  ]: On test.jaffle_shop.assert_stg_payments_total_value_positive: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.assert_stg_payments_total_value_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with

payments as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
)

select
    order_id,
    sum(amount) as total_amount
from payments
group by order_id
having total_amount < 0
      
    ) dbt_internal_test
22:45:15.920822 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
22:45:15.921626 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
22:45:15.921730 [debug] [Thread-5  ]: Opening a new connection, currently in state init
22:45:15.922512 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned','placed'
)



      
    ) dbt_internal_test
22:45:15.923439 [debug] [Thread-6  ]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
where id is null



      
    ) dbt_internal_test
22:45:16.041624 [debug] [Thread-5  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:45:17.562719 [debug] [Thread-2  ]: finished collecting timing info
22:45:17.564545 [debug] [Thread-4  ]: finished collecting timing info
22:45:17.565024 [info ] [Thread-2  ]: 2 of 11 PASS assert_stg_payments_total_value_positive........................... [[32mPASS[0m in 1.71s]
22:45:17.565338 [info ] [Thread-4  ]: 4 of 11 PASS not_null_stg_orders_order_id....................................... [[32mPASS[0m in 1.71s]
22:45:17.565649 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:45:17.565851 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:45:17.566036 [debug] [Thread-2  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:45:17.566470 [debug] [Thread-4  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:45:17.566869 [info ] [Thread-2  ]: 7 of 11 START test source_not_null_jaffle_shop_orders_id........................ [RUN]
22:45:17.567183 [info ] [Thread-4  ]: 8 of 11 START test source_unique_jaffle_shop_customers_id....................... [RUN]
22:45:17.567763 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:45:17.568136 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:45:17.568287 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:45:17.568472 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:45:17.568650 [debug] [Thread-2  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:45:17.568763 [debug] [Thread-4  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:45:17.572086 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:45:17.577130 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:45:17.577698 [debug] [Thread-2  ]: finished collecting timing info
22:45:17.577806 [debug] [Thread-4  ]: finished collecting timing info
22:45:17.577939 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:45:17.578053 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:45:17.579702 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:45:17.581371 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:45:17.581798 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:45:17.581938 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
22:45:17.583115 [debug] [Thread-2  ]: On test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
where id is null



      
    ) dbt_internal_test
22:45:17.618722 [debug] [Thread-4  ]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:45:17.649747 [debug] [Thread-5  ]: finished collecting timing info
22:45:17.650022 [info ] [Thread-5  ]: 5 of 11 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [[32mPASS[0m in 1.80s]
22:45:17.650274 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:45:17.650428 [debug] [Thread-5  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:45:17.650610 [info ] [Thread-5  ]: 9 of 11 START test source_unique_jaffle_shop_orders_id.......................... [RUN]
22:45:17.650993 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:45:17.651102 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:45:17.651191 [debug] [Thread-5  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:45:17.655933 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:45:17.656922 [debug] [Thread-5  ]: finished collecting timing info
22:45:17.657029 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:45:17.661137 [debug] [Thread-5  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:45:17.662042 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
22:45:17.662944 [debug] [Thread-5  ]: On test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:45:17.695729 [debug] [Thread-3  ]: finished collecting timing info
22:45:17.697143 [debug] [Thread-6  ]: finished collecting timing info
22:45:17.698189 [debug] [Thread-1  ]: finished collecting timing info
22:45:17.698448 [info ] [Thread-3  ]: 3 of 11 PASS not_null_stg_customers_customer_id................................. [[32mPASS[0m in 1.85s]
22:45:17.698804 [info ] [Thread-6  ]: 6 of 11 PASS source_not_null_jaffle_shop_customers_id........................... [[32mPASS[0m in 1.84s]
22:45:17.699125 [info ] [Thread-1  ]: 1 of 11 PASS accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [[32mPASS[0m in 1.85s]
22:45:17.699526 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:45:17.699813 [debug] [Thread-6  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:45:17.699993 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:45:17.700275 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:45:17.700563 [debug] [Thread-6  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:45:17.700841 [info ] [Thread-3  ]: 10 of 11 START test unique_stg_customers_customer_id............................ [RUN]
22:45:17.700947 [info ] [Thread-6  ]: 11 of 11 START test unique_stg_orders_order_id.................................. [RUN]
22:45:17.701307 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:45:17.701792 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:45:17.701945 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:45:17.702268 [debug] [Thread-6  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:45:17.702384 [debug] [Thread-3  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:45:17.702479 [debug] [Thread-6  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:45:17.705266 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:45:17.707549 [debug] [Thread-6  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:45:17.707965 [debug] [Thread-3  ]: finished collecting timing info
22:45:17.708065 [debug] [Thread-6  ]: finished collecting timing info
22:45:17.708143 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:45:17.708234 [debug] [Thread-6  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:45:17.709380 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:45:17.710459 [debug] [Thread-6  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:45:17.710769 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
22:45:17.710863 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
22:45:17.711837 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:45:17.712644 [debug] [Thread-6  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:45:19.040859 [debug] [Thread-3  ]: finished collecting timing info
22:45:19.041266 [info ] [Thread-3  ]: 10 of 11 PASS unique_stg_customers_customer_id.................................. [[32mPASS[0m in 1.34s]
22:45:19.041506 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:45:19.054740 [debug] [Thread-4  ]: finished collecting timing info
22:45:19.055114 [info ] [Thread-4  ]: 8 of 11 PASS source_unique_jaffle_shop_customers_id............................. [[32mPASS[0m in 1.49s]
22:45:19.055348 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:45:19.068808 [debug] [Thread-2  ]: finished collecting timing info
22:45:19.069139 [info ] [Thread-2  ]: 7 of 11 PASS source_not_null_jaffle_shop_orders_id.............................. [[32mPASS[0m in 1.50s]
22:45:19.069373 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:45:19.086418 [debug] [Thread-5  ]: finished collecting timing info
22:45:19.086769 [info ] [Thread-5  ]: 9 of 11 PASS source_unique_jaffle_shop_orders_id................................ [[32mPASS[0m in 1.44s]
22:45:19.086994 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:45:19.140629 [debug] [Thread-6  ]: finished collecting timing info
22:45:19.141023 [info ] [Thread-6  ]: 11 of 11 PASS unique_stg_orders_order_id........................................ [[32mPASS[0m in 1.44s]
22:45:19.141240 [debug] [Thread-6  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:45:19.142413 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:45:19.142720 [info ] [MainThread]: 
22:45:19.142903 [info ] [MainThread]: Finished running 11 tests in 4.02s.
22:45:19.143078 [debug] [MainThread]: Connection 'master' was properly closed.
22:45:19.143164 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7' was properly closed.
22:45:19.143247 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13' was properly closed.
22:45:19.143325 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
22:45:19.143401 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e' was properly closed.
22:45:19.143478 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba' was properly closed.
22:45:19.143554 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
22:45:19.148806 [info ] [MainThread]: 
22:45:19.149034 [info ] [MainThread]: [32mCompleted successfully[0m
22:45:19.149211 [info ] [MainThread]: 
22:45:19.149350 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
22:45:19.149559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a42700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a42e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e09eb0>]}


============================== 2022-05-19 22:46:25.907010 | fe949a36-387b-4e57-9db3-f33aad69275b ==============================
22:46:25.907010 [info ] [MainThread]: Running with dbt=1.0.4
22:46:25.907951 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['source:jaffle_shop'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:46:25.908472 [debug] [MainThread]: Tracking: tracking
22:46:25.930920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0632e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d479be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f063250>]}
22:46:25.960204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:46:25.960382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:46:25.964390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe949a36-387b-4e57-9db3-f33aad69275b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1e20d0>]}
22:46:25.969468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe949a36-387b-4e57-9db3-f33aad69275b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f13bdf0>]}
22:46:25.969666 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:46:25.970844 [info ] [MainThread]: 
22:46:25.971172 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:46:25.971944 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:46:25.972123 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:46:26.795035 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:46:26.795802 [info ] [MainThread]: 
22:46:26.804124 [debug] [Thread-1  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:46:26.804359 [debug] [Thread-2  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:46:26.804595 [debug] [Thread-3  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:46:26.804778 [debug] [Thread-4  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:46:26.805022 [info ] [Thread-1  ]: 1 of 4 START test source_not_null_jaffle_shop_customers_id...................... [RUN]
22:46:26.805302 [info ] [Thread-2  ]: 2 of 4 START test source_not_null_jaffle_shop_orders_id......................... [RUN]
22:46:26.805588 [info ] [Thread-3  ]: 3 of 4 START test source_unique_jaffle_shop_customers_id........................ [RUN]
22:46:26.805834 [info ] [Thread-4  ]: 4 of 4 START test source_unique_jaffle_shop_orders_id........................... [RUN]
22:46:26.806374 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:46:26.806968 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:46:26.807543 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:46:26.807982 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:46:26.808136 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:46:26.808281 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:46:26.808408 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:46:26.808525 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:46:26.808687 [debug] [Thread-1  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:46:26.808809 [debug] [Thread-2  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:46:26.808927 [debug] [Thread-3  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:46:26.809040 [debug] [Thread-4  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:46:26.819277 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:46:26.822385 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:46:26.827276 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:46:26.829944 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:46:26.830978 [debug] [Thread-1  ]: finished collecting timing info
22:46:26.831189 [debug] [Thread-3  ]: finished collecting timing info
22:46:26.831309 [debug] [Thread-2  ]: finished collecting timing info
22:46:26.831401 [debug] [Thread-4  ]: finished collecting timing info
22:46:26.831540 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:46:26.831668 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:46:26.831779 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:46:26.831890 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:46:26.847050 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:46:26.848229 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:46:26.849281 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:46:26.850338 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:46:26.850725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:46:26.850990 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:46:26.851072 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:46:26.851283 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:46:26.852199 [debug] [Thread-1  ]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
where id is null



      
    ) dbt_internal_test
22:46:26.853026 [debug] [Thread-3  ]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:46:26.853836 [debug] [Thread-2  ]: On test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
where id is null



      
    ) dbt_internal_test
22:46:26.884184 [debug] [Thread-4  ]: On test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:46:28.612779 [debug] [Thread-4  ]: finished collecting timing info
22:46:28.614325 [debug] [Thread-3  ]: finished collecting timing info
22:46:28.615762 [debug] [Thread-1  ]: finished collecting timing info
22:46:28.616948 [debug] [Thread-2  ]: finished collecting timing info
22:46:28.617586 [info ] [Thread-4  ]: 4 of 4 PASS source_unique_jaffle_shop_orders_id................................. [[32mPASS[0m in 1.81s]
22:46:28.618965 [info ] [Thread-3  ]: 3 of 4 PASS source_unique_jaffle_shop_customers_id.............................. [[32mPASS[0m in 1.81s]
22:46:28.619225 [info ] [Thread-1  ]: 1 of 4 PASS source_not_null_jaffle_shop_customers_id............................ [[32mPASS[0m in 1.81s]
22:46:28.619475 [info ] [Thread-2  ]: 2 of 4 PASS source_not_null_jaffle_shop_orders_id............................... [[32mPASS[0m in 1.81s]
22:46:28.619676 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:46:28.620081 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:46:28.620317 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:46:28.620535 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:46:28.622089 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:46:28.622442 [info ] [MainThread]: 
22:46:28.622666 [info ] [MainThread]: Finished running 4 tests in 2.65s.
22:46:28.622864 [debug] [MainThread]: Connection 'master' was properly closed.
22:46:28.622969 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f' was properly closed.
22:46:28.623064 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13' was properly closed.
22:46:28.623157 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e' was properly closed.
22:46:28.623248 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba' was properly closed.
22:46:28.628655 [info ] [MainThread]: 
22:46:28.628902 [info ] [MainThread]: [32mCompleted successfully[0m
22:46:28.629103 [info ] [MainThread]: 
22:46:28.629271 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
22:46:28.629511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1cb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1c9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f326700>]}


============================== 2022-05-19 22:50:44.444906 | 2a8a50e2-5f78-4c44-8846-be62a6878a6b ==============================
22:50:44.444906 [info ] [MainThread]: Running with dbt=1.0.4
22:50:44.445807 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:50:44.446236 [debug] [MainThread]: Tracking: tracking
22:50:44.470418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11110e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11110e880>]}
22:50:44.501109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:50:44.501319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:50:44.505737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a8a50e2-5f78-4c44-8846-be62a6878a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e7e0d0>]}
22:50:44.511455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a8a50e2-5f78-4c44-8846-be62a6878a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dd2940>]}
22:50:44.511686 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:50:44.513209 [info ] [MainThread]: 
22:50:44.513537 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:50:44.514339 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:50:44.514495 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:45.408604 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:50:45.409389 [info ] [MainThread]: 
22:50:45.417790 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:50:45.418069 [debug] [Thread-2  ]: Began running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:50:45.418241 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:50:45.418386 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:50:45.418514 [debug] [Thread-5  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:50:45.418669 [debug] [Thread-6  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:50:45.418898 [info ] [Thread-1  ]: 1 of 11 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [RUN]
22:50:45.419119 [info ] [Thread-2  ]: 2 of 11 START test assert_stg_payments_total_value_positive..................... [RUN]
22:50:45.419288 [info ] [Thread-3  ]: 3 of 11 START test not_null_stg_customers_customer_id........................... [RUN]
22:50:45.419452 [info ] [Thread-4  ]: 4 of 11 START test not_null_stg_orders_order_id................................. [RUN]
22:50:45.419614 [info ] [Thread-5  ]: 5 of 11 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
22:50:45.419769 [info ] [Thread-6  ]: 6 of 11 START test source_not_null_jaffle_shop_customers_id..................... [RUN]
22:50:45.420390 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:50:45.420809 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:50:45.421268 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:50:45.421677 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:50:45.422543 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:50:45.423225 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:50:45.423428 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:50:45.423599 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.assert_stg_payments_total_value_positive
22:50:45.423867 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:50:45.424141 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:50:45.424380 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:50:45.424676 [debug] [Thread-6  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:50:45.424883 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:50:45.425037 [debug] [Thread-2  ]: Compiling test.jaffle_shop.assert_stg_payments_total_value_positive
22:50:45.425178 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:50:45.425351 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:50:45.425518 [debug] [Thread-5  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:50:45.425666 [debug] [Thread-6  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:50:45.439846 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:50:45.441698 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:50:45.446398 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:50:45.449140 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:50:45.454764 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:50:45.457221 [debug] [Thread-6  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:50:45.458645 [debug] [Thread-2  ]: finished collecting timing info
22:50:45.458924 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.assert_stg_payments_total_value_positive
22:50:45.459085 [debug] [Thread-3  ]: finished collecting timing info
22:50:45.459230 [debug] [Thread-1  ]: finished collecting timing info
22:50:45.459315 [debug] [Thread-6  ]: finished collecting timing info
22:50:45.459405 [debug] [Thread-4  ]: finished collecting timing info
22:50:45.459502 [debug] [Thread-5  ]: finished collecting timing info
22:50:45.474415 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:50:45.474617 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:50:45.474732 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:50:45.474817 [debug] [Thread-6  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:50:45.474927 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:50:45.475034 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:50:45.476867 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:50:45.477926 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:50:45.478946 [debug] [Thread-6  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:50:45.479066 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:50:45.480098 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:50:45.481097 [debug] [Thread-5  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:50:45.482310 [debug] [Thread-2  ]: On test.jaffle_shop.assert_stg_payments_total_value_positive: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.assert_stg_payments_total_value_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with

payments as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
)

select
    order_id,
    sum(amount) as total_amount
from payments
group by order_id
having total_amount < 0
      
    ) dbt_internal_test
22:50:45.482419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:50:45.482525 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:50:45.512462 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:50:45.513581 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned','placed'
)



      
    ) dbt_internal_test
22:50:45.513701 [debug] [Thread-5  ]: Opening a new connection, currently in state init
22:50:45.514623 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
22:50:45.543817 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:50:45.544637 [debug] [Thread-6  ]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
where id is null



      
    ) dbt_internal_test
22:50:45.575018 [debug] [Thread-5  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:50:45.576041 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
22:50:47.117200 [debug] [Thread-4  ]: finished collecting timing info
22:50:47.118260 [info ] [Thread-4  ]: 4 of 11 PASS not_null_stg_orders_order_id....................................... [[32mPASS[0m in 1.70s]
22:50:47.120148 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:50:47.120427 [debug] [Thread-4  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:50:47.120944 [info ] [Thread-4  ]: 7 of 11 START test source_not_null_jaffle_shop_orders_id........................ [RUN]
22:50:47.121930 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:50:47.125319 [debug] [Thread-5  ]: finished collecting timing info
22:50:47.125586 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:50:47.126114 [info ] [Thread-5  ]: 5 of 11 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [[32mPASS[0m in 1.70s]
22:50:47.126369 [debug] [Thread-4  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:50:47.126698 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:50:47.132158 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:50:47.132473 [debug] [Thread-5  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:50:47.133135 [info ] [Thread-5  ]: 8 of 11 START test source_unique_jaffle_shop_customers_id....................... [RUN]
22:50:47.133810 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:50:47.134365 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:50:47.134547 [debug] [Thread-4  ]: finished collecting timing info
22:50:47.134820 [debug] [Thread-5  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:50:47.135016 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:50:47.142091 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:50:47.144062 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:50:47.145908 [debug] [Thread-5  ]: finished collecting timing info
22:50:47.146102 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
22:50:47.146259 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:50:47.147829 [debug] [Thread-5  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:50:47.149030 [debug] [Thread-4  ]: On test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
where id is null



      
    ) dbt_internal_test
22:50:47.186771 [debug] [Thread-1  ]: finished collecting timing info
22:50:47.187773 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
22:50:47.189253 [debug] [Thread-3  ]: finished collecting timing info
22:50:47.189530 [info ] [Thread-1  ]: 1 of 11 PASS accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [[32mPASS[0m in 1.77s]
22:50:47.190643 [debug] [Thread-2  ]: finished collecting timing info
22:50:47.191942 [info ] [Thread-3  ]: 3 of 11 PASS not_null_stg_customers_customer_id................................. [[32mPASS[0m in 1.77s]
22:50:47.192168 [debug] [Thread-5  ]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:50:47.192404 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:50:47.192602 [info ] [Thread-2  ]: 2 of 11 PASS assert_stg_payments_total_value_positive........................... [[32mPASS[0m in 1.77s]
22:50:47.192814 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:50:47.223094 [debug] [Thread-1  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:50:47.223388 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:50:47.223502 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:50:47.223625 [info ] [Thread-1  ]: 9 of 11 START test source_unique_jaffle_shop_orders_id.......................... [RUN]
22:50:47.223751 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:50:47.223875 [info ] [Thread-3  ]: 10 of 11 START test unique_stg_customers_customer_id............................ [RUN]
22:50:47.224179 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:50:47.224274 [info ] [Thread-2  ]: 11 of 11 START test unique_stg_orders_order_id.................................. [RUN]
22:50:47.224497 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:50:47.224586 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:50:47.224796 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:50:47.224875 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:50:47.224966 [debug] [Thread-1  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:50:47.225041 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:50:47.225518 [debug] [Thread-3  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:50:47.226828 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:50:47.229158 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:50:47.232768 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:50:47.233686 [debug] [Thread-3  ]: finished collecting timing info
22:50:47.234126 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:50:47.235339 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:50:47.235552 [debug] [Thread-2  ]: finished collecting timing info
22:50:47.235881 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:50:47.236948 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:50:47.237392 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
22:50:47.238944 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:50:47.239144 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:50:47.274356 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:50:47.275295 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:50:47.305808 [debug] [Thread-1  ]: finished collecting timing info
22:50:47.305976 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:50:47.313239 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:50:47.313777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:50:47.314688 [debug] [Thread-1  ]: On test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:50:47.346549 [debug] [Thread-6  ]: finished collecting timing info
22:50:47.346856 [info ] [Thread-6  ]: 6 of 11 PASS source_not_null_jaffle_shop_customers_id........................... [[32mPASS[0m in 1.92s]
22:50:47.347230 [debug] [Thread-6  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:50:48.660995 [debug] [Thread-3  ]: finished collecting timing info
22:50:48.662217 [info ] [Thread-3  ]: 10 of 11 PASS unique_stg_customers_customer_id.................................. [[32mPASS[0m in 1.44s]
22:50:48.662783 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:50:48.708317 [debug] [Thread-4  ]: finished collecting timing info
22:50:48.709470 [debug] [Thread-5  ]: finished collecting timing info
22:50:48.709861 [info ] [Thread-4  ]: 7 of 11 PASS source_not_null_jaffle_shop_orders_id.............................. [[32mPASS[0m in 1.59s]
22:50:48.710129 [info ] [Thread-5  ]: 8 of 11 PASS source_unique_jaffle_shop_customers_id............................. [[32mPASS[0m in 1.58s]
22:50:48.710441 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:50:48.710663 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:50:48.767062 [debug] [Thread-1  ]: finished collecting timing info
22:50:48.767533 [info ] [Thread-1  ]: 9 of 11 PASS source_unique_jaffle_shop_orders_id................................ [[32mPASS[0m in 1.54s]
22:50:48.767799 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:50:48.971450 [debug] [Thread-2  ]: finished collecting timing info
22:50:48.972355 [info ] [Thread-2  ]: 11 of 11 PASS unique_stg_orders_order_id........................................ [[32mPASS[0m in 1.75s]
22:50:48.972814 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:50:48.975165 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:50:48.975927 [info ] [MainThread]: 
22:50:48.976350 [info ] [MainThread]: Finished running 11 tests in 4.46s.
22:50:48.976701 [debug] [MainThread]: Connection 'master' was properly closed.
22:50:48.976898 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba' was properly closed.
22:50:48.977073 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
22:50:48.977240 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
22:50:48.977400 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13' was properly closed.
22:50:48.977561 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e' was properly closed.
22:50:48.977722 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f' was properly closed.
22:50:48.987121 [info ] [MainThread]: 
22:50:48.987509 [info ] [MainThread]: [32mCompleted successfully[0m
22:50:48.987806 [info ] [MainThread]: 
22:50:48.988045 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
22:50:48.988393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e7e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e49f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d03b80>]}


============================== 2022-05-19 22:51:07.573797 | a3d5ffb9-3db2-4575-91d2-92fc015f10b4 ==============================
22:51:07.573797 [info ] [MainThread]: Running with dbt=1.0.4
22:51:07.574737 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['test_type:generic'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:51:07.575223 [debug] [MainThread]: Tracking: tracking
22:51:07.608440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11079d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11079d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11079d0a0>]}
22:51:07.638423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:51:07.638641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:51:07.643015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3d5ffb9-3db2-4575-91d2-92fc015f10b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109050d0>]}
22:51:07.648213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3d5ffb9-3db2-4575-91d2-92fc015f10b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110846af0>]}
22:51:07.648421 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:51:07.649766 [info ] [MainThread]: 
22:51:07.650094 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:07.650935 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:51:07.651096 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:51:08.393323 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:51:08.394214 [info ] [MainThread]: 
22:51:08.402535 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:08.402790 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:51:08.402993 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:08.403210 [debug] [Thread-4  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:08.403374 [debug] [Thread-5  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:51:08.403590 [info ] [Thread-1  ]: 1 of 10 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [RUN]
22:51:08.403778 [debug] [Thread-6  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:51:08.404014 [info ] [Thread-2  ]: 2 of 10 START test not_null_stg_customers_customer_id........................... [RUN]
22:51:08.404248 [info ] [Thread-3  ]: 3 of 10 START test not_null_stg_orders_order_id................................. [RUN]
22:51:08.404450 [info ] [Thread-4  ]: 4 of 10 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
22:51:08.404620 [info ] [Thread-5  ]: 5 of 10 START test source_not_null_jaffle_shop_customers_id..................... [RUN]
22:51:08.405189 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:51:08.405391 [info ] [Thread-6  ]: 6 of 10 START test source_not_null_jaffle_shop_orders_id........................ [RUN]
22:51:08.406037 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:51:08.406590 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:51:08.407098 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:51:08.407703 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:51:08.407968 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:08.408599 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:51:08.408797 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:51:08.408967 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:08.409154 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:08.409342 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:51:08.409599 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:08.409757 [debug] [Thread-6  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:51:08.410158 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:51:08.410432 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:08.410592 [debug] [Thread-4  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:08.410741 [debug] [Thread-5  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:51:08.426947 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:51:08.427215 [debug] [Thread-6  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:51:08.432663 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:51:08.435590 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:51:08.441675 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:51:08.444236 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:51:08.446879 [debug] [Thread-6  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:51:08.447284 [debug] [Thread-1  ]: finished collecting timing info
22:51:08.447467 [debug] [Thread-2  ]: finished collecting timing info
22:51:08.447557 [debug] [Thread-3  ]: finished collecting timing info
22:51:08.447725 [debug] [Thread-4  ]: finished collecting timing info
22:51:08.447912 [debug] [Thread-5  ]: finished collecting timing info
22:51:08.448065 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:08.448148 [debug] [Thread-6  ]: finished collecting timing info
22:51:08.448247 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:51:08.448354 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:08.448449 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:08.448543 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:51:08.463217 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:51:08.463383 [debug] [Thread-6  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:51:08.465318 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
22:51:08.466323 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:51:08.467287 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:51:08.468260 [debug] [Thread-5  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
22:51:08.469385 [debug] [Thread-6  ]: Writing runtime SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
22:51:08.469677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:51:08.469782 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:51:08.469953 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:51:08.470195 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:51:08.470418 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:51:08.470506 [debug] [Thread-5  ]: Opening a new connection, currently in state init
22:51:08.471377 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned','placed'
)



      
    ) dbt_internal_test
22:51:08.472214 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
22:51:08.472933 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
22:51:08.473695 [debug] [Thread-4  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:51:08.474450 [debug] [Thread-6  ]: On test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
where id is null



      
    ) dbt_internal_test
22:51:08.475145 [debug] [Thread-5  ]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
where id is null



      
    ) dbt_internal_test
22:51:09.882978 [debug] [Thread-1  ]: finished collecting timing info
22:51:09.883506 [info ] [Thread-1  ]: 1 of 10 PASS accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [[32mPASS[0m in 1.48s]
22:51:09.883805 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:09.883962 [debug] [Thread-1  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:51:09.884184 [info ] [Thread-1  ]: 7 of 10 START test source_unique_jaffle_shop_customers_id....................... [RUN]
22:51:09.884555 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:51:09.884682 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:51:09.884825 [debug] [Thread-1  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:51:09.890182 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:51:09.890576 [debug] [Thread-1  ]: finished collecting timing info
22:51:09.890694 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:51:09.892032 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
22:51:09.892328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:51:09.893539 [debug] [Thread-1  ]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`customers`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:51:10.010921 [debug] [Thread-5  ]: finished collecting timing info
22:51:10.011352 [info ] [Thread-5  ]: 5 of 10 PASS source_not_null_jaffle_shop_customers_id........................... [[32mPASS[0m in 1.60s]
22:51:10.011582 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
22:51:10.011719 [debug] [Thread-5  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:51:10.011934 [info ] [Thread-5  ]: 8 of 10 START test source_unique_jaffle_shop_orders_id.......................... [RUN]
22:51:10.012285 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:51:10.012403 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:51:10.012515 [debug] [Thread-5  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:51:10.015526 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:51:10.015904 [debug] [Thread-5  ]: finished collecting timing info
22:51:10.016032 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:51:10.017366 [debug] [Thread-5  ]: Writing runtime SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
22:51:10.017679 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
22:51:10.018794 [debug] [Thread-5  ]: On test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`orders`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:51:10.143864 [debug] [Thread-4  ]: finished collecting timing info
22:51:10.145150 [debug] [Thread-3  ]: finished collecting timing info
22:51:10.146117 [debug] [Thread-2  ]: finished collecting timing info
22:51:10.146406 [info ] [Thread-4  ]: 4 of 10 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [[32mPASS[0m in 1.74s]
22:51:10.146661 [info ] [Thread-3  ]: 3 of 10 PASS not_null_stg_orders_order_id....................................... [[32mPASS[0m in 1.74s]
22:51:10.146881 [info ] [Thread-2  ]: 2 of 10 PASS not_null_stg_customers_customer_id................................. [[32mPASS[0m in 1.74s]
22:51:10.147106 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:10.147284 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:10.147454 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
22:51:10.147834 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:51:10.148134 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:10.148403 [info ] [Thread-4  ]: 9 of 10 START test unique_stg_customers_customer_id............................. [RUN]
22:51:10.148541 [info ] [Thread-3  ]: 10 of 10 START test unique_stg_orders_order_id.................................. [RUN]
22:51:10.148875 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:51:10.149154 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:51:10.149266 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:51:10.149375 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:10.149492 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:51:10.149598 [debug] [Thread-3  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:10.154059 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:51:10.154974 [debug] [Thread-3  ]: finished collecting timing info
22:51:10.155626 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:10.157255 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:51:10.160356 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:51:10.160784 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
22:51:10.160907 [debug] [Thread-4  ]: finished collecting timing info
22:51:10.161074 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:51:10.167490 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
22:51:10.168388 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:51:10.200077 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
22:51:10.201207 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:51:10.384068 [debug] [Thread-6  ]: finished collecting timing info
22:51:10.384514 [info ] [Thread-6  ]: 6 of 10 PASS source_not_null_jaffle_shop_orders_id.............................. [[32mPASS[0m in 1.98s]
22:51:10.384794 [debug] [Thread-6  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
22:51:11.334939 [debug] [Thread-1  ]: finished collecting timing info
22:51:11.336031 [info ] [Thread-1  ]: 7 of 10 PASS source_unique_jaffle_shop_customers_id............................. [[32mPASS[0m in 1.45s]
22:51:11.336603 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
22:51:11.455901 [debug] [Thread-5  ]: finished collecting timing info
22:51:11.457197 [info ] [Thread-5  ]: 8 of 10 PASS source_unique_jaffle_shop_orders_id................................ [[32mPASS[0m in 1.44s]
22:51:11.457772 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
22:51:11.498403 [debug] [Thread-3  ]: finished collecting timing info
22:51:11.499163 [info ] [Thread-3  ]: 10 of 10 PASS unique_stg_orders_order_id........................................ [[32mPASS[0m in 1.35s]
22:51:11.499545 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:11.780445 [debug] [Thread-4  ]: finished collecting timing info
22:51:11.781557 [info ] [Thread-4  ]: 9 of 10 PASS unique_stg_customers_customer_id................................... [[32mPASS[0m in 1.63s]
22:51:11.782029 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
22:51:11.784320 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:11.785009 [info ] [MainThread]: 
22:51:11.785342 [info ] [MainThread]: Finished running 10 tests in 4.13s.
22:51:11.785648 [debug] [MainThread]: Connection 'master' was properly closed.
22:51:11.785813 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e' was properly closed.
22:51:11.785959 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
22:51:11.786101 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
22:51:11.786240 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
22:51:11.786373 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba' was properly closed.
22:51:11.786507 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13' was properly closed.
22:51:11.796361 [info ] [MainThread]: 
22:51:11.796824 [info ] [MainThread]: [32mCompleted successfully[0m
22:51:11.797148 [info ] [MainThread]: 
22:51:11.797396 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
22:51:11.797796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cfca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ebcd0>]}


============================== 2022-05-19 22:51:23.223600 | 4f297cd6-686f-4a96-a778-ee02b15eb53d ==============================
22:51:23.223600 [info ] [MainThread]: Running with dbt=1.0.4
22:51:23.224465 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['test_type:singular'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:51:23.224651 [debug] [MainThread]: Tracking: tracking
22:51:23.244518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeede80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeedee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeed250>]}
22:51:23.269496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:51:23.269731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:51:23.274050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f297cd6-686f-4a96-a778-ee02b15eb53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f08b0d0>]}
22:51:23.279682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f297cd6-686f-4a96-a778-ee02b15eb53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efd6790>]}
22:51:23.279917 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:51:23.281008 [info ] [MainThread]: 
22:51:23.281312 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:23.282115 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:51:23.282351 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:51:24.064942 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:51:24.065853 [info ] [MainThread]: 
22:51:24.073906 [debug] [Thread-1  ]: Began running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:51:24.074231 [info ] [Thread-1  ]: 1 of 1 START test assert_stg_payments_total_value_positive...................... [RUN]
22:51:24.074783 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:51:24.074966 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.assert_stg_payments_total_value_positive
22:51:24.075201 [debug] [Thread-1  ]: Compiling test.jaffle_shop.assert_stg_payments_total_value_positive
22:51:24.078870 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:51:24.079617 [debug] [Thread-1  ]: finished collecting timing info
22:51:24.079773 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.assert_stg_payments_total_value_positive
22:51:24.098132 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
22:51:24.098691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:51:24.099953 [debug] [Thread-1  ]: On test.jaffle_shop.assert_stg_payments_total_value_positive: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.assert_stg_payments_total_value_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with

payments as (
    select * from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_payments`
)

select
    order_id,
    sum(amount) as total_amount
from payments
group by order_id
having total_amount < 0
      
    ) dbt_internal_test
22:51:25.340924 [debug] [Thread-1  ]: finished collecting timing info
22:51:25.341513 [info ] [Thread-1  ]: 1 of 1 PASS assert_stg_payments_total_value_positive............................ [[32mPASS[0m in 1.27s]
22:51:25.341880 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.assert_stg_payments_total_value_positive
22:51:25.343209 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:25.343565 [info ] [MainThread]: 
22:51:25.343809 [info ] [MainThread]: Finished running 1 test in 2.06s.
22:51:25.344027 [debug] [MainThread]: Connection 'master' was properly closed.
22:51:25.344149 [debug] [MainThread]: Connection 'test.jaffle_shop.assert_stg_payments_total_value_positive' was properly closed.
22:51:25.352281 [info ] [MainThread]: 
22:51:25.352637 [info ] [MainThread]: [32mCompleted successfully[0m
22:51:25.352872 [info ] [MainThread]: 
22:51:25.353057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:51:25.353336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efd64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efd69a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f13fe20>]}


============================== 2022-05-19 22:51:37.616743 | 252c349c-3569-4b23-b8e1-342b1fb05ff8 ==============================
22:51:37.616743 [info ] [MainThread]: Running with dbt=1.0.4
22:51:37.617402 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:51:37.617862 [debug] [MainThread]: Tracking: tracking
22:51:37.638179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7a3a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbd8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbd2790>]}
22:51:37.663300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:51:37.663497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:51:37.667628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '252c349c-3569-4b23-b8e1-342b1fb05ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9410d0>]}
22:51:37.672451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '252c349c-3569-4b23-b8e1-342b1fb05ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8978e0>]}
22:51:37.672632 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:51:37.673835 [info ] [MainThread]: 
22:51:37.674145 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:37.674937 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:51:37.675104 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:51:38.350275 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:51:38.351054 [info ] [MainThread]: 
22:51:38.357417 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:38.357688 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:38.357879 [debug] [Thread-3  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:38.358108 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:38.358287 [info ] [Thread-1  ]: 1 of 4 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [RUN]
22:51:38.358514 [info ] [Thread-2  ]: 2 of 4 START test not_null_stg_orders_order_id.................................. [RUN]
22:51:38.358694 [info ] [Thread-3  ]: 3 of 4 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
22:51:38.358880 [info ] [Thread-4  ]: 4 of 4 START test unique_stg_orders_order_id.................................... [RUN]
22:51:38.359432 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:51:38.360467 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:51:38.360987 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:51:38.361414 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:51:38.361678 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:38.361898 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:38.362061 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:38.362214 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:38.362440 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:38.362595 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:38.362743 [debug] [Thread-3  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:38.362889 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:38.378654 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:51:38.383792 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:51:38.390030 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:51:38.394515 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:51:38.395135 [debug] [Thread-1  ]: finished collecting timing info
22:51:38.395363 [debug] [Thread-2  ]: finished collecting timing info
22:51:38.395457 [debug] [Thread-3  ]: finished collecting timing info
22:51:38.395663 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:38.395825 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:38.395988 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:38.396072 [debug] [Thread-4  ]: finished collecting timing info
22:51:38.411249 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:51:38.412447 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:51:38.413577 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:51:38.413753 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:38.414184 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:51:38.414354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:51:38.415511 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:51:38.415606 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:51:38.416643 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
22:51:38.418166 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned','placed'
)



      
    ) dbt_internal_test
22:51:38.419048 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:51:38.419146 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:51:38.508244 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:51:39.807467 [debug] [Thread-1  ]: finished collecting timing info
22:51:39.808089 [info ] [Thread-1  ]: 1 of 4 PASS accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [[32mPASS[0m in 1.45s]
22:51:39.808439 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:39.852350 [debug] [Thread-2  ]: finished collecting timing info
22:51:39.852771 [info ] [Thread-2  ]: 2 of 4 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 1.49s]
22:51:39.853005 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:39.899135 [debug] [Thread-4  ]: finished collecting timing info
22:51:39.899546 [info ] [Thread-4  ]: 4 of 4 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 1.54s]
22:51:39.899787 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:39.922019 [debug] [Thread-3  ]: finished collecting timing info
22:51:39.922413 [info ] [Thread-3  ]: 3 of 4 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [[32mPASS[0m in 1.56s]
22:51:39.922641 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:39.923820 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:39.924194 [info ] [MainThread]: 
22:51:39.924406 [info ] [MainThread]: Finished running 4 tests in 2.25s.
22:51:39.924586 [debug] [MainThread]: Connection 'master' was properly closed.
22:51:39.924684 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7' was properly closed.
22:51:39.924773 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
22:51:39.924858 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
22:51:39.924945 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
22:51:39.929840 [info ] [MainThread]: 
22:51:39.930037 [info ] [MainThread]: [32mCompleted successfully[0m
22:51:39.930213 [info ] [MainThread]: 
22:51:39.930361 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
22:51:39.930583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e897c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8973d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e928a90>]}


============================== 2022-05-19 22:51:49.030571 | e207551c-0a87-4b7f-b8f3-9c691954efba ==============================
22:51:49.030571 [info ] [MainThread]: Running with dbt=1.0.4
22:51:49.031234 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_orders'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
22:51:49.031658 [debug] [MainThread]: Tracking: tracking
22:51:49.049977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f46af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d87e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d87e9a0>]}
22:51:49.074985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:51:49.075189 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:51:49.079341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e207551c-0a87-4b7f-b8f3-9c691954efba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5f50d0>]}
22:51:49.084760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e207551c-0a87-4b7f-b8f3-9c691954efba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5498b0>]}
22:51:49.084980 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:51:49.086323 [info ] [MainThread]: 
22:51:49.086681 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:49.087498 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
22:51:49.087644 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:51:49.633507 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
22:51:49.635068 [info ] [MainThread]: 
22:51:49.642281 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:49.642565 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:49.642798 [debug] [Thread-3  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:49.643065 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:49.643279 [info ] [Thread-1  ]: 1 of 4 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [RUN]
22:51:49.643540 [info ] [Thread-2  ]: 2 of 4 START test not_null_stg_orders_order_id.................................. [RUN]
22:51:49.643750 [info ] [Thread-3  ]: 3 of 4 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
22:51:49.643962 [info ] [Thread-4  ]: 4 of 4 START test unique_stg_orders_order_id.................................... [RUN]
22:51:49.644729 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:51:49.645364 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:51:49.645991 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:51:49.646483 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:51:49.646966 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:49.647379 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:49.647668 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:49.647871 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:49.648171 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:49.648379 [debug] [Thread-2  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:49.648560 [debug] [Thread-3  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:49.648726 [debug] [Thread-4  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:49.665309 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:51:49.669803 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:51:49.676467 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:51:49.681276 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:51:49.681897 [debug] [Thread-2  ]: finished collecting timing info
22:51:49.682040 [debug] [Thread-1  ]: finished collecting timing info
22:51:49.682199 [debug] [Thread-3  ]: finished collecting timing info
22:51:49.682333 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:49.682467 [debug] [Thread-4  ]: finished collecting timing info
22:51:49.682545 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:49.682651 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:49.698065 [debug] [Thread-2  ]: Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
22:51:49.698228 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:49.699287 [debug] [Thread-1  ]: Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
22:51:49.700340 [debug] [Thread-3  ]: Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
22:51:49.701573 [debug] [Thread-4  ]: Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
22:51:49.702039 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:51:49.702385 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:51:49.702522 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:51:49.703551 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
22:51:49.703661 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:51:49.705356 [debug] [Thread-3  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
22:51:49.706284 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned','placed'
)



      
    ) dbt_internal_test
22:51:49.736891 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select order_id as unique_field
  from `dbt-fundamentals-346323`.`jaffle_shop`.`stg_orders`
  where order_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
22:51:51.066552 [debug] [Thread-4  ]: finished collecting timing info
22:51:51.067121 [info ] [Thread-4  ]: 4 of 4 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 1.42s]
22:51:51.067432 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
22:51:51.121917 [debug] [Thread-3  ]: finished collecting timing info
22:51:51.122318 [info ] [Thread-3  ]: 3 of 4 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [[32mPASS[0m in 1.48s]
22:51:51.122535 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
22:51:51.171466 [debug] [Thread-1  ]: finished collecting timing info
22:51:51.172435 [debug] [Thread-2  ]: finished collecting timing info
22:51:51.172788 [info ] [Thread-1  ]: 1 of 4 PASS accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed [[32mPASS[0m in 1.53s]
22:51:51.173020 [info ] [Thread-2  ]: 2 of 4 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 1.53s]
22:51:51.173224 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
22:51:51.173391 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
22:51:51.174473 [debug] [MainThread]: Acquiring new bigquery connection "master"
22:51:51.174737 [info ] [MainThread]: 
22:51:51.174910 [info ] [MainThread]: Finished running 4 tests in 2.09s.
22:51:51.175072 [debug] [MainThread]: Connection 'master' was properly closed.
22:51:51.175185 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7' was properly closed.
22:51:51.175278 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
22:51:51.175372 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
22:51:51.175451 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
22:51:51.179948 [info ] [MainThread]: 
22:51:51.180176 [info ] [MainThread]: [32mCompleted successfully[0m
22:51:51.180363 [info ] [MainThread]: 
22:51:51.180516 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
22:51:51.180740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5e0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f549130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5dbdc0>]}


============================== 2022-05-19 22:58:53.425200 | d30576ab-a854-49e9-9a06-6324f06d3bf8 ==============================
22:58:53.425200 [info ] [MainThread]: Running with dbt=1.0.4
22:58:53.426085 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, output=None, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.freshness.FreshnessTask'>, which='source-freshness', rpc_method='source-freshness')
22:58:53.426567 [debug] [MainThread]: Tracking: tracking
22:58:53.450522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e847bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc12c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e847df0>]}
22:58:53.484232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:58:53.484448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:58:53.488806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd30576ab-a854-49e9-9a06-6324f06d3bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9c20d0>]}
22:58:53.494344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd30576ab-a854-49e9-9a06-6324f06d3bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9173a0>]}
22:58:53.494589 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
22:58:53.495860 [info ] [MainThread]: 
22:58:53.496045 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
22:58:53.499750 [info ] [MainThread]: Done.
22:58:53.499998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9175e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e917430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e917940>]}


============================== 2022-05-19 23:46:32.374696 | d8a11fd1-6a20-4479-b11d-8ddecb1e681b ==============================
23:46:32.374696 [info ] [MainThread]: Running with dbt=1.0.4
23:46:32.375748 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
23:46:32.375947 [debug] [MainThread]: Tracking: tracking
23:46:32.399457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b596a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b59e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b59250>]}
23:46:32.430996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
23:46:32.431381 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/jaffle_shop.md
23:46:32.431693 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
23:46:32.431872 [debug] [MainThread]: Partial parsing: deleted source source.jaffle_shop.jaffle_shop.customers
23:46:32.431953 [debug] [MainThread]: Partial parsing: deleted source source.jaffle_shop.jaffle_shop.orders
23:46:32.432037 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
23:46:32.440343 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
23:46:32.448014 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
23:46:32.495624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da92b0>]}


============================== 2022-05-19 23:47:13.197219 | c9775bbd-fc73-4657-bf1e-94e10258b254 ==============================
23:47:13.197219 [info ] [MainThread]: Running with dbt=1.0.4
23:47:13.198367 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
23:47:13.198577 [debug] [MainThread]: Tracking: tracking
23:47:13.218586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113332400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11172ea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173c3a0>]}
23:47:13.248524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
23:47:13.248921 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/jaffle_shop.md
23:47:13.249264 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
23:47:13.249460 [debug] [MainThread]: Partial parsing: deleted source source.jaffle_shop.jaffle_shop.customers
23:47:13.249546 [debug] [MainThread]: Partial parsing: deleted source source.jaffle_shop.jaffle_shop.orders
23:47:13.249636 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
23:47:13.260447 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
23:47:13.268208 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
23:47:13.322489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9775bbd-fc73-4657-bf1e-94e10258b254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11356c070>]}
23:47:13.327431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9775bbd-fc73-4657-bf1e-94e10258b254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133313a0>]}
23:47:13.327609 [info ] [MainThread]: Found 5 models, 11 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
23:47:13.329008 [info ] [MainThread]: 
23:47:13.329319 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:47:13.329958 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-fundamentals-346323_jaffle_shop"
23:47:13.330153 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:47:14.093901 [info ] [MainThread]: Concurrency: 6 threads (target='dev')
23:47:14.094904 [info ] [MainThread]: 
23:47:14.103481 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
23:47:14.103714 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
23:47:14.104018 [debug] [Thread-3  ]: Began running node model.jaffle_shop.stg_payments
23:47:14.104205 [debug] [Thread-4  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
23:47:14.104362 [debug] [Thread-5  ]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
23:47:14.104507 [debug] [Thread-6  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
23:47:14.104935 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
23:47:14.105350 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
23:47:14.105731 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
23:47:14.106077 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
23:47:14.106395 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
23:47:14.106711 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
23:47:14.106897 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
23:47:14.107066 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
23:47:14.107223 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.stg_payments
23:47:14.107420 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
23:47:14.107645 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
23:47:14.107854 [debug] [Thread-6  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
23:47:14.108111 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
23:47:14.108610 [debug] [Thread-2  ]: Compiling model.jaffle_shop.stg_orders
23:47:14.109028 [debug] [Thread-3  ]: Compiling model.jaffle_shop.stg_payments
23:47:14.109238 [debug] [Thread-4  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
23:47:14.109415 [debug] [Thread-5  ]: Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
23:47:14.109593 [debug] [Thread-6  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
23:47:14.113176 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
23:47:14.116318 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
23:47:14.124732 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
23:47:14.126599 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
23:47:14.131036 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
23:47:14.135897 [debug] [Thread-6  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
23:47:14.137300 [debug] [Thread-2  ]: finished collecting timing info
23:47:14.137513 [debug] [Thread-1  ]: finished collecting timing info
23:47:14.137703 [debug] [Thread-4  ]: finished collecting timing info
23:47:14.137811 [debug] [Thread-6  ]: finished collecting timing info
23:47:14.137929 [debug] [Thread-3  ]: finished collecting timing info
23:47:14.138031 [debug] [Thread-5  ]: finished collecting timing info
23:47:14.138135 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
23:47:14.138259 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
23:47:14.138376 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
23:47:14.138486 [debug] [Thread-6  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
23:47:14.138590 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.stg_payments
23:47:14.138691 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
23:47:14.138828 [debug] [Thread-2  ]: finished collecting timing info
23:47:14.138943 [debug] [Thread-1  ]: finished collecting timing info
23:47:14.139048 [debug] [Thread-4  ]: finished collecting timing info
23:47:14.139154 [debug] [Thread-6  ]: finished collecting timing info
23:47:14.139257 [debug] [Thread-3  ]: finished collecting timing info
23:47:14.139361 [debug] [Thread-5  ]: finished collecting timing info
23:47:14.139652 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
23:47:14.139887 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
23:47:14.140127 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
23:47:14.140337 [debug] [Thread-6  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
23:47:14.140550 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.stg_payments
23:47:14.140749 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
23:47:14.140893 [debug] [Thread-2  ]: Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
23:47:14.141196 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
23:47:14.141433 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
23:47:14.141595 [debug] [Thread-6  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
23:47:14.141748 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
23:47:14.141976 [debug] [Thread-5  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
23:47:14.142204 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
23:47:14.142409 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
23:47:14.142603 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
23:47:14.142787 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
23:47:14.142974 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
23:47:14.143139 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
23:47:14.143236 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
23:47:14.143332 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
23:47:14.143420 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
23:47:14.143506 [debug] [Thread-6  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
23:47:14.143595 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
23:47:14.143681 [debug] [Thread-5  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
23:47:14.143775 [debug] [Thread-2  ]: Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
23:47:14.143863 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
23:47:14.143949 [debug] [Thread-4  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
23:47:14.144035 [debug] [Thread-6  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
23:47:14.144121 [debug] [Thread-3  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
23:47:14.144207 [debug] [Thread-5  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
23:47:14.146918 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
23:47:14.150757 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7"
23:47:14.153116 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
23:47:14.155313 [debug] [Thread-6  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
23:47:14.157394 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
23:47:14.160312 [debug] [Thread-5  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
23:47:14.161062 [debug] [Thread-2  ]: finished collecting timing info
23:47:14.161197 [debug] [Thread-6  ]: finished collecting timing info
23:47:14.161398 [debug] [Thread-5  ]: finished collecting timing info
23:47:14.161576 [debug] [Thread-1  ]: finished collecting timing info
23:47:14.161675 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
23:47:14.161824 [debug] [Thread-6  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
23:47:14.161934 [debug] [Thread-4  ]: finished collecting timing info
23:47:14.162015 [debug] [Thread-3  ]: finished collecting timing info
23:47:14.162081 [debug] [Thread-5  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
23:47:14.162180 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
23:47:14.162282 [debug] [Thread-2  ]: finished collecting timing info
23:47:14.162373 [debug] [Thread-6  ]: finished collecting timing info
23:47:14.162459 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
23:47:14.162541 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
23:47:14.162626 [debug] [Thread-5  ]: finished collecting timing info
23:47:14.162713 [debug] [Thread-1  ]: finished collecting timing info
23:47:14.162932 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
23:47:14.163120 [debug] [Thread-6  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
23:47:14.163213 [debug] [Thread-4  ]: finished collecting timing info
23:47:14.163299 [debug] [Thread-3  ]: finished collecting timing info
23:47:14.163464 [debug] [Thread-5  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
23:47:14.163629 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned__placed.3e58cf49d7
23:47:14.163742 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
23:47:14.163894 [debug] [Thread-6  ]: Began running node model.jaffle_shop.dim_customers
23:47:14.164126 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
23:47:14.164312 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
23:47:14.164418 [debug] [Thread-5  ]: Began running node model.jaffle_shop.fct_orders
23:47:14.164558 [debug] [Thread-1  ]: Began running node test.jaffle_shop.assert_stg_payments_total_value_positive
23:47:14.164742 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
23:47:14.164914 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
23:47:14.165188 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.jaffle_shop.fct_orders"
23:47:14.165342 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.jaffle_shop.assert_stg_payments_total_value_positive"
23:47:14.165428 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
23:47:14.165511 [debug] [Thread-6  ]: Began compiling node model.jaffle_shop.dim_customers
23:47:14.165591 [debug] [Thread-5  ]: Began compiling node model.jaffle_shop.fct_orders
23:47:14.165667 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.assert_stg_payments_total_value_positive
23:47:14.165749 [debug] [Thread-2  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
23:47:14.165828 [debug] [Thread-6  ]: Compiling model.jaffle_shop.dim_customers
23:47:14.165907 [debug] [Thread-5  ]: Compiling model.jaffle_shop.fct_orders
23:47:14.165984 [debug] [Thread-1  ]: Compiling test.jaffle_shop.assert_stg_payments_total_value_positive
23:47:14.168229 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
23:47:14.170003 [debug] [Thread-6  ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
23:47:14.172392 [debug] [Thread-5  ]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
23:47:14.173597 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_total_value_positive"
23:47:14.174057 [debug] [Thread-6  ]: finished collecting timing info
23:47:14.174392 [debug] [Thread-6  ]: Began executing node model.jaffle_shop.dim_customers
23:47:14.174562 [debug] [Thread-6  ]: finished collecting timing info
23:47:14.174654 [debug] [Thread-1  ]: finished collecting timing info
23:47:14.174838 [debug] [Thread-6  ]: Finished running node model.jaffle_shop.dim_customers
23:47:14.174921 [debug] [Thread-2  ]: finished collecting timing info
23:47:14.175035 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.assert_stg_payments_total_value_positive
23:47:14.175207 [debug] [Thread-5  ]: finished collecting timing info
23:47:14.175278 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
23:47:14.175366 [debug] [Thread-1  ]: finished collecting timing info
23:47:14.175444 [debug] [Thread-5  ]: Began executing node model.jaffle_shop.fct_orders
23:47:14.175525 [debug] [Thread-2  ]: finished collecting timing info
23:47:14.175700 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.assert_stg_payments_total_value_positive
23:47:14.175787 [debug] [Thread-5  ]: finished collecting timing info
23:47:14.175944 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
23:47:14.176177 [debug] [Thread-5  ]: Finished running node model.jaffle_shop.fct_orders
23:47:14.176942 [debug] [MainThread]: Connection 'master' was properly closed.
23:47:14.177052 [debug] [MainThread]: Connection 'test.jaffle_shop.assert_stg_payments_total_value_positive' was properly closed.
23:47:14.177123 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
23:47:14.177191 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
23:47:14.177260 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
23:47:14.177325 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
23:47:14.177390 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
23:47:14.182335 [info ] [MainThread]: Done.
23:47:14.187860 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
23:47:14.188030 [info ] [MainThread]: Building catalog
23:47:14.188655 [debug] [MainThread]: Opening a new connection, currently in state init
23:47:14.981298 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-fundamentals-346323.information_schema"
23:47:14.982227 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-fundamentals-346323.information_schema"
23:47:15.002865 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:47:15.004525 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:47:15.006356 [debug] [ThreadPool]: On dbt-fundamentals-346323.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbt-fundamentals-346323.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-fundamentals-346323`.`jaffle_shop`.__TABLES__
        where (upper(dataset_id) = upper('jaffle_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-fundamentals-346323`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-fundamentals-346323`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
23:47:15.007816 [debug] [ThreadPool]: On dbt-fundamentals-346323.information_schema: /* {"app": "dbt", "dbt_version": "1.0.4", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbt-fundamentals-346323.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-fundamentals-346323`.`stripe`.__TABLES__
        where (upper(dataset_id) = upper('stripe'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-fundamentals-346323`.`stripe`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-fundamentals-346323`.`stripe`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
23:47:18.649760 [info ] [MainThread]: Catalog written to /Users/lizyau/code/dbt-fundamentals/target/catalog.json
23:47:18.650114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11172ea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134cd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134cdcd0>]}
23:47:19.225237 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:47:19.226569 [debug] [MainThread]: Connection 'dbt-fundamentals-346323.information_schema' was properly closed.
23:47:19.226868 [debug] [MainThread]: Connection 'dbt-fundamentals-346323.information_schema' was properly closed.


============================== 2022-05-19 23:55:19.937069 | 06cd2bfe-3f2e-4d0c-8b17-fe5e36d37715 ==============================
23:55:19.937069 [info ] [MainThread]: Running with dbt=1.0.4
23:55:19.938206 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/lizyau/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
23:55:19.938475 [debug] [MainThread]: Tracking: tracking
23:55:19.963377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c6250>]}
23:55:19.966502 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:55:19.966935 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:55:19.967109 [info ] [MainThread]: 
23:55:19.967257 [info ] [MainThread]: 
23:55:19.967386 [info ] [MainThread]: Press Ctrl+C to exit.
